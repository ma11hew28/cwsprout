<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
  .KEYW {color: #933;}
  .COMM {color: #bbb; font-style: italic;}
  .NUMB {color: #393;}
  .STRN {color: #393;}
  .REGX {color: #339;}
  .line {border-right: 1px dotted #666; color: #666; font-style: normal;}
  </style></head><body><pre><span class='line'>  1</span> <span class="COMM">// ========================================================================</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">// SproutCore</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="COMM">// copyright 2006-2008 Sprout Systems, Inc.</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="COMM">// ========================================================================</span><span class="WHIT">
<span class='line'>  5</span> 
<span class='line'>  6</span> </span><span class="NAME">require</span><span class="PUNC">(</span><span class="STRN">'foundation/object'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="NAME">require</span><span class="PUNC">(</span><span class="STRN">'foundation/responder'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="NAME">require</span><span class="PUNC">(</span><span class="STRN">'foundation/node_descriptor'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="NAME">require</span><span class="PUNC">(</span><span class="STRN">'foundation/binding'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="NAME">require</span><span class="PUNC">(</span><span class="STRN">'foundation/path_module'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 11</span> 
<span class='line'> 12</span> </span><span class="NAME">require</span><span class="PUNC">(</span><span class="STRN">'mixins/delegate_support'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 13</span> 
<span class='line'> 14</span> </span><span class="NAME">SC.BENCHMARK_OUTLETS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="NAME">SC.BENCHMARK_CONFIGURE_OUTLETS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 16</span> 
<span class='line'> 17</span> </span><span class="COMM">/** 
<span class='line'> 18</span>   @class
<span class='line'> 19</span>   
<span class='line'> 20</span>   A view is the root class you use to manage the web page DOM in your
<span class='line'> 21</span>   application.  You can use views to render visible content on your page,
<span class='line'> 22</span>   provide animations, and to capture and respond to events.  
<span class='line'> 23</span> 
<span class='line'> 24</span>   You can use SC.View directly to manage DOM elements or you can extend one
<span class='line'> 25</span>   of the many subclasses provided by SproutCore.  This documentation describes
<span class='line'> 26</span>   the general concepts you need to understand when working with views, though
<span class='line'> 27</span>   most often you will want to work with one of the subclasses instead.
<span class='line'> 28</span>   
<span class='line'> 29</span>   h2. Working with DOM Elements
<span class='line'> 30</span>   
<span class='line'> 31</span>   h2. Handling Events
<span class='line'> 32</span>   
<span class='line'> 33</span>   @extends SC.Responder
<span class='line'> 34</span>   @extends SC.PathModule
<span class='line'> 35</span>   @extends SC.DelegateSupport
<span class='line'> 36</span>   @since SproutCore 1.0
<span class='line'> 37</span> */</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="NAME">SC.View</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Responder.extend</span><span class="PUNC">(</span><span class="NAME">SC.PathModule</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="NAME">SC.DelegateSupport</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="COMM">/** @scope SC.View.prototype */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 40</span> 
<span class='line'> 41</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'> 42</span>   </span><span class="COMM">// VIEW API</span><span class="WHIT">
<span class='line'> 43</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 44</span>   </span><span class="COMM">// The methods in this section are used to manage actual views.  You can</span><span class="WHIT">
<span class='line'> 45</span>   </span><span class="COMM">// basically interact with child elements in two ways.  One using an API</span><span class="WHIT">
<span class='line'> 46</span>   </span><span class="COMM">// similar to the DOM API.  Alternatively, you can treat the view like an</span><span class="WHIT">
<span class='line'> 47</span>   </span><span class="COMM">// array and use standard iterators.</span><span class="WHIT">
<span class='line'> 48</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'> 49</span> 
<span class='line'> 50</span>   </span><span class="COMM">/**
<span class='line'> 51</span>     Insert the view into the the receiver's childNodes array.
<span class='line'> 52</span>     
<span class='line'> 53</span>     The view will be added to the childNodes array before the beforeView.  If 
<span class='line'> 54</span>     beforeView is null, then the view will be added to the end of the array.  
<span class='line'> 55</span>     This will also add the view's rootElement DOM node to the receivers 
<span class='line'> 56</span>     containerElement DOM node as a child.
<span class='line'> 57</span> 
<span class='line'> 58</span>     If the specified view already belongs to another parent, it will be 
<span class='line'> 59</span>     removed from that view first.
<span class='line'> 60</span>     
<span class='line'> 61</span>     @param view {SC.View} the view to insert as a child node.
<span class='line'> 62</span>     @param beforeView {SC.View} view to insert before, or null to insert at 
<span class='line'> 63</span>      end
<span class='line'> 64</span>     @returns {SC.View} the receiver
<span class='line'> 65</span>   */</span><span class="WHIT">
<span class='line'> 66</span>   </span><span class="NAME">insertBefore</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'> 67</span>     </span><span class="NAME">this._insertBefore</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="NAME">beforeView</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 68</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 69</span> 
<span class='line'> 70</span>   </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'> 71</span>   </span><span class="NAME">_insertBefore</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">updateDom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 72</span>     </span><span class="COMM">// verify that beforeView is a child.</span><span class="WHIT">
<span class='line'> 73</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 74</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">beforeView.parentNode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"insertBefore() beforeView must belong to the receiver"</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 75</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">beforeView</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"insertBefore() views cannot be the same"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 76</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 77</span>     
<span class='line'> 78</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">view.removeFromParent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 79</span>     </span><span class="NAME">this.willAddChild</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 80</span>     </span><span class="NAME">view.willAddToParent</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 81</span>     
<span class='line'> 82</span>     </span><span class="COMM">// patch in the view.</span><span class="WHIT">
<span class='line'> 83</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 84</span>       </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'previousSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView.previousSibling</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 85</span>       </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span>       </span><span class="NAME">beforeView.set</span><span class="PUNC">(</span><span class="STRN">'previousSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">      
<span class='line'> 87</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 88</span>       </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'previousSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.lastChild</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 89</span>       </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 90</span>       </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'lastChild'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 91</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 92</span> 
<span class='line'> 93</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.previousSibling</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">view.previousSibling.set</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">,</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 94</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.previousSibling</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">,</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 95</span>     </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'parentNode'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 96</span> 
<span class='line'> 97</span>     </span><span class="COMM">// Update DOM. -- ANIMATE</span><span class="WHIT">
<span class='line'> 98</span>     </span><span class="COMM">// Note that this code is not called when outlets are first configured.</span><span class="WHIT">
<span class='line'> 99</span>     </span><span class="COMM">// The assumption is that the created view already belongs to the </span><span class="WHIT">
<span class='line'>100</span>     </span><span class="COMM">// document somwhere.</span><span class="WHIT">
<span class='line'>101</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">updateDom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>102</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">beforeElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">beforeView.rootElement</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>103</span>       
<span class='line'>104</span>       </span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">insertBefore</span><span class="PUNC">(</span><span class="NAME">view.rootElement</span><span class="PUNC">,</span><span class="NAME">beforeElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>105</span> 
<span class='line'>106</span>       </span><span class="COMM">// regenerate the childNodes array.</span><span class="WHIT">
<span class='line'>107</span>       </span><span class="NAME">this._rebuildChildNodes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>108</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>109</span> 
<span class='line'>110</span>     </span><span class="COMM">// update cached states.</span><span class="WHIT">
<span class='line'>111</span>     </span><span class="NAME">view._updateIsVisibleInWindow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>112</span>     </span><span class="NAME">view._flushInternalCaches</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>113</span>     </span><span class="NAME">view._invalidateClippingFrame</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>114</span>     
<span class='line'>115</span>     </span><span class="COMM">// call notices.</span><span class="WHIT">
<span class='line'>116</span>     </span><span class="NAME">view.didAddToParent</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>117</span>     </span><span class="NAME">this.didAddChild</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>118</span>     </span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>119</span>     	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>120</span> 	</span><span class="PUNC">}</span><span class="KEYW">finally</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>121</span> 		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">beforeElement</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>122</span> 		  </span><span class="NAME">beforeElement</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>123</span> 	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>124</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>125</span> 
<span class='line'>126</span>   </span><span class="COMM">/**
<span class='line'>127</span>     Remove the view from the receiver's childNodes array.  
<span class='line'>128</span>     
<span class='line'>129</span>     This will also remove the view's DOM element from the recievers DOM.
<span class='line'>130</span>     
<span class='line'>131</span>     @param view {SC.View} the view to remove
<span class='line'>132</span>     @returns {SC.View} the receiver
<span class='line'>133</span>   */</span><span class="WHIT">
<span class='line'>134</span>   </span><span class="NAME">removeChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>135</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>136</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.parentNode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"removeChild: view must belong to parent"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>137</span>     
<span class='line'>138</span>     </span><span class="NAME">view.willRemoveFromParent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>139</span>     </span><span class="NAME">this.willRemoveChild</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>140</span>     
<span class='line'>141</span>     </span><span class="COMM">// unpatch.</span><span class="WHIT">
<span class='line'>142</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.previousSibling</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>143</span>       </span><span class="NAME">view.previousSibling.set</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view.nextSibling</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>144</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view.nextSibling</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>145</span>     
<span class='line'>146</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.nextSibling</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>147</span>       </span><span class="NAME">view.nextSibling.set</span><span class="PUNC">(</span><span class="STRN">'previousSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view.previousSibling</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>148</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'lastChild'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view.previousSibling</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>149</span> 
<span class='line'>150</span>     </span><span class="COMM">// Update DOM -- ANIMATE</span><span class="WHIT">
<span class='line'>151</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>152</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.rootElement.parentNode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>153</span>       </span><span class="NAME">el.removeChild</span><span class="PUNC">(</span><span class="NAME">view.rootElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>154</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>155</span>     
<span class='line'>156</span>     </span><span class="COMM">// regenerate the childNodes array.</span><span class="WHIT">
<span class='line'>157</span>     </span><span class="NAME">this._rebuildChildNodes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>158</span> 
<span class='line'>159</span>     </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>160</span>     </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'previousSibling'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>161</span>     </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'parentNode'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>162</span>     
<span class='line'>163</span>     </span><span class="COMM">// update parent state.</span><span class="WHIT">
<span class='line'>164</span>     </span><span class="NAME">view._updateIsVisibleInWindow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>165</span>     </span><span class="NAME">view._flushInternalCaches</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>166</span>     </span><span class="NAME">view._invalidateClippingFrame</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>167</span>     
<span class='line'>168</span>     </span><span class="NAME">view.didRemoveFromParent</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>169</span>     </span><span class="NAME">this.didRemoveChild</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>170</span> 	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>171</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>172</span> </span><span class="PUNC">}</span><span class="KEYW">finally</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>173</span> 	</span><span class="NAME">el</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>174</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>175</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>176</span> 
<span class='line'>177</span>   </span><span class="COMM">/**
<span class='line'>178</span>     Replace the oldView with the specified view in the receivers childNodes 
<span class='line'>179</span>     array. This will also replace the DOM node of the oldView with the DOM 
<span class='line'>180</span>     node of the new view in the receivers DOM.
<span class='line'>181</span> 
<span class='line'>182</span>     If the specified view already belongs to another parent, it will be 
<span class='line'>183</span>     removed from that view first.
<span class='line'>184</span> 
<span class='line'>185</span>     @param view {SC.View} the view to insert in the DOM
<span class='line'>186</span>     @param view {SC.View} the view to remove from the DOM.
<span class='line'>187</span>     @returns {SC.View} the receiver
<span class='line'>188</span>   */</span><span class="WHIT">
<span class='line'>189</span>   </span><span class="NAME">replaceChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">oldView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>190</span>     </span><span class="NAME">this.insertBefore</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="NAME">oldView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">this.removeChild</span><span class="PUNC">(</span><span class="NAME">oldView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>191</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>192</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>193</span> 
<span class='line'>194</span>   </span><span class="COMM">/**
<span class='line'>195</span>     Removes the receiver from its parentNode.  If the receiver does not belong
<span class='line'>196</span>     to a parentNode,  this method does nothing.
<span class='line'>197</span>     
<span class='line'>198</span>     @returns {null}
<span class='line'>199</span>   */</span><span class="WHIT">
<span class='line'>200</span>   </span><span class="NAME">removeFromParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>201</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.parentNode.removeChild</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">    
<span class='line'>202</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>203</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>204</span> 
<span class='line'>205</span>   </span><span class="COMM">/** 
<span class='line'>206</span>     Works just like removeFromParent but also removes the view from internal
<span class='line'>207</span>     caches and sets the rootElement to null so that the view and its DOM can
<span class='line'>208</span>     be garbage collected.
<span class='line'>209</span>     
<span class='line'>210</span>     SproutCore includes special gaurds that ensure views and their related 
<span class='line'>211</span>     DOM elements will be garbage collected whenever your web page unloads.
<span class='line'>212</span>     However, if you create and destroy views frequently while your application
<span class='line'>213</span>     is running, you should call this method when views are no longer needed
<span class='line'>214</span>     to ensure they will be garbage collected even while your application is
<span class='line'>215</span>     still running.
<span class='line'>216</span>     
<span class='line'>217</span>     @returns {null}
<span class='line'>218</span>   */</span><span class="WHIT">
<span class='line'>219</span>   </span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>220</span>     </span><span class="NAME">this.removeFromParent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>221</span>     </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">SC.View._view</span><span class="PUNC">[</span><span class="NAME">SC.guidFor</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>222</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>223</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>224</span>   
<span class='line'>225</span>   </span><span class="COMM">/**
<span class='line'>226</span>     Appends the specified view to the end of the receivers childNodes array.  
<span class='line'>227</span>     This is equivalent to calling insertBefore(view, null);
<span class='line'>228</span>     
<span class='line'>229</span>     @param view {SC.View} the view to insert
<span class='line'>230</span>     @returns {SC.View} the receiver 
<span class='line'>231</span>   */</span><span class="WHIT">
<span class='line'>232</span>   </span><span class="NAME">appendChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>233</span>     </span><span class="NAME">this.insertBefore</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">   
<span class='line'>234</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>235</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>236</span> 
<span class='line'>237</span>   </span><span class="COMM">/**
<span class='line'>238</span>     The array of views that are direct children of the receiver view.  The DOM 
<span class='line'>239</span>     elements managed by the views are also directl children of the 
<span class='line'>240</span>     containerElement for the receiver.
<span class='line'>241</span>     
<span class='line'>242</span>     @field
<span class='line'>243</span>     @type Array
<span class='line'>244</span>   */</span><span class="WHIT">
<span class='line'>245</span>   </span><span class="NAME">childNodes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>246</span> 
<span class='line'>247</span>   </span><span class="COMM">/**
<span class='line'>248</span>     The first child view in the childNodes array.  If the view does not have 
<span class='line'>249</span>     any children, this property will be null.
<span class='line'>250</span>      
<span class='line'>251</span>     @field
<span class='line'>252</span>     @type SC.View
<span class='line'>253</span>   */</span><span class="WHIT">
<span class='line'>254</span>   </span><span class="NAME">firstChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>255</span>   
<span class='line'>256</span>   </span><span class="COMM">/**
<span class='line'>257</span>     The last child view in the childNodes array.  If the view does not have any children,
<span class='line'>258</span>     this property will be null.
<span class='line'>259</span>      
<span class='line'>260</span>     @field
<span class='line'>261</span>     @type SC.View
<span class='line'>262</span>   */</span><span class="WHIT">
<span class='line'>263</span>   </span><span class="NAME">lastChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>264</span>   
<span class='line'>265</span>   </span><span class="COMM">/**
<span class='line'>266</span>     The next sibling view in the childNodes array of the receivers parentNode.  
<span class='line'>267</span>     If the receiver is the last view in the array or if the receiver does not 
<span class='line'>268</span>     belong to a parent view this property will be null.
<span class='line'>269</span>      
<span class='line'>270</span>     @field
<span class='line'>271</span>     @type SC.View
<span class='line'>272</span>   */</span><span class="WHIT">
<span class='line'>273</span>   </span><span class="NAME">nextSibling</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>274</span> 
<span class='line'>275</span>   </span><span class="COMM">/**
<span class='line'>276</span>     The previous sibling view in the childNodes array of the receivers 
<span class='line'>277</span>     parentNode.  If the receiver is the first view in the array or if the 
<span class='line'>278</span>     receiver does not belong to a parent view this property will be null.
<span class='line'>279</span>      
<span class='line'>280</span>     @field
<span class='line'>281</span>     @type SC.View
<span class='line'>282</span>   */</span><span class="WHIT">
<span class='line'>283</span>   </span><span class="NAME">previousSibling</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>284</span> 
<span class='line'>285</span>   </span><span class="COMM">/**
<span class='line'>286</span>     The parent view this view belongs to.  If the receiver does not belong to a parent view
<span class='line'>287</span>     then this property is null.
<span class='line'>288</span>      
<span class='line'>289</span>     @field
<span class='line'>290</span>     @type SC.View
<span class='line'>291</span>   */</span><span class="WHIT">
<span class='line'>292</span>   </span><span class="NAME">parentNode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>293</span>   
<span class='line'>294</span> 
<span class='line'>295</span>   </span><span class="COMM">/**
<span class='line'>296</span>     The pane this view belongs to.  The pane is the root of the responder 
<span class='line'>297</span>     chain that this view belongs to.  Typically a view's pane will be the 
<span class='line'>298</span>     SC.window object. However, if you have added the view to a dialog, panel, 
<span class='line'>299</span>     popup or other pane, this property will point to that pane instead.
<span class='line'>300</span>     
<span class='line'>301</span>     If the view does not belong to a parentNode or if the view is not 
<span class='line'>302</span>     onscreen, this property will be null.
<span class='line'>303</span>     
<span class='line'>304</span>     @field
<span class='line'>305</span>     @type SC.View
<span class='line'>306</span>   */</span><span class="WHIT">
<span class='line'>307</span>   </span><span class="NAME">pane</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>308</span>   </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>309</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>310</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'parentNode'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>311</span>     </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>312</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'isPane'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>313</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>314</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>316</span>   
<span class='line'>317</span> 
<span class='line'>318</span>   </span><span class="COMM">/**
<span class='line'>319</span>     Removes all child views from the receiver.
<span class='line'>320</span>     
<span class='line'>321</span>     @returns {void}  
<span class='line'>322</span>   */</span><span class="WHIT">
<span class='line'>323</span>   </span><span class="NAME">clear</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>324</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">this.firstChild</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.removeChild</span><span class="PUNC">(</span><span class="NAME">this.firstChild</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>325</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>326</span> 
<span class='line'>327</span>   </span><span class="COMM">/**
<span class='line'>328</span>     This method is called on the view just before it is added to a new parent 
<span class='line'>329</span>     view.  
<span class='line'>330</span>     
<span class='line'>331</span>     You can override this method to do any setup you need on your view or to 
<span class='line'>332</span>     reset any cached values that are impacted by being added to a view.  The 
<span class='line'>333</span>     default implementation does nothing.
<span class='line'>334</span>     
<span class='line'>335</span>     @param parent {SC.View} the new parent
<span class='line'>336</span>     @paran beforeView {SC.View} the view in the parent's childNodes array that 
<span class='line'>337</span>       will follow this view once it is added.  If the view is being added to 
<span class='line'>338</span>       the end of the array, this will be null.
<span class='line'>339</span>     @returns {void}
<span class='line'>340</span>   */</span><span class="WHIT">
<span class='line'>341</span>   </span><span class="NAME">willAddToParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>342</span>   
<span class='line'>343</span>   </span><span class="COMM">/**
<span class='line'>344</span>     This method is called on the view just after it is added to a new parent 
<span class='line'>345</span>     view.  
<span class='line'>346</span>     
<span class='line'>347</span>     You can override this method to do any setup you need on your view or to 
<span class='line'>348</span>     reset any cached values that are impacted by being added to a view.  The 
<span class='line'>349</span>     default implementation does nothing.
<span class='line'>350</span>     
<span class='line'>351</span>     @param parent {SC.View} the new parent
<span class='line'>352</span>     @paran beforeView {SC.View} the view in the parent's childNodes array that 
<span class='line'>353</span>       will follow this view once it is added.  If the view is being added to 
<span class='line'>354</span>       the end of the array, this will be null.
<span class='line'>355</span>     @returns {void}
<span class='line'>356</span>   */</span><span class="WHIT">
<span class='line'>357</span>   </span><span class="NAME">didAddToParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>358</span>   
<span class='line'>359</span>   </span><span class="COMM">/**
<span class='line'>360</span>     This method is called on the view just before it is removed from a parent 
<span class='line'>361</span>     view.  
<span class='line'>362</span>     
<span class='line'>363</span>     You can override this method to clear out any values that depend on the 
<span class='line'>364</span>     view belonging to the current parentNode.  The default implementation does 
<span class='line'>365</span>     nothing.
<span class='line'>366</span>     
<span class='line'>367</span>     @returns {void}
<span class='line'>368</span>   */</span><span class="WHIT">
<span class='line'>369</span>   </span><span class="NAME">willRemoveFromParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>370</span>   
<span class='line'>371</span>   </span><span class="COMM">/**
<span class='line'>372</span>     This method is called on the view just after it is removed from a parent 
<span class='line'>373</span>     view.  
<span class='line'>374</span>     
<span class='line'>375</span>     You can override this method to clear out any values that depend on the 
<span class='line'>376</span>     view belonging to the current parentNode.  The default implementation does 
<span class='line'>377</span>     nothing.
<span class='line'>378</span> 
<span class='line'>379</span>     @param oldParent {SC.View} the old parent view
<span class='line'>380</span>     @returns {void}
<span class='line'>381</span>   */</span><span class="WHIT">
<span class='line'>382</span>   </span><span class="NAME">didRemoveFromParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">oldParent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>383</span> 
<span class='line'>384</span>   </span><span class="COMM">/**
<span class='line'>385</span>     This method is called just before a new child view is added to the 
<span class='line'>386</span>     receiver's childNodes array.  You can use this to prepare for any layout 
<span class='line'>387</span>     or other cleanup you might need to do.
<span class='line'>388</span>     
<span class='line'>389</span>     The default implementation does nothing.
<span class='line'>390</span>     
<span class='line'>391</span>     @param child {SC.View} the view to be added
<span class='line'>392</span>     @param beforeView {SC.View} and existing child view that will follow the 
<span class='line'>393</span>       child view in the array once it is added.  If adding to the end of the 
<span class='line'>394</span>       array, this param will be null.
<span class='line'>395</span>     @returns {void}
<span class='line'>396</span>   */</span><span class="WHIT">
<span class='line'>397</span>   </span><span class="NAME">willAddChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>398</span>   
<span class='line'>399</span>   </span><span class="COMM">/**
<span class='line'>400</span>     This method is called just after a new child view is added to the 
<span class='line'>401</span>     receiver's childNodes array.  You can use this to prepare for any layout 
<span class='line'>402</span>     or other cleanup you might need to do.
<span class='line'>403</span>     
<span class='line'>404</span>     The default implementation does nothing.
<span class='line'>405</span>     
<span class='line'>406</span>     @param child {SC.View} the view that was added
<span class='line'>407</span>     @param beforeView {SC.View} and existing child view that will follow the 
<span class='line'>408</span>       child view in the array once it is added.  If adding to the end of the 
<span class='line'>409</span>       array, this param will be null.
<span class='line'>410</span>     @returns {void}
<span class='line'>411</span>   */</span><span class="WHIT">
<span class='line'>412</span>   </span><span class="NAME">didAddChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>413</span>   
<span class='line'>414</span>   </span><span class="COMM">/**
<span class='line'>415</span>     This method is called just before a child view is removed from the 
<span class='line'>416</span>     receiver's childNodes array.  You can use this to prepare for any layout 
<span class='line'>417</span>     or other cleanup you might need to do.
<span class='line'>418</span>     
<span class='line'>419</span>     The default implementation does nothing.
<span class='line'>420</span>     
<span class='line'>421</span>     @param child {SC.View} the view to be removed
<span class='line'>422</span>     @returns {void}
<span class='line'>423</span>   */</span><span class="WHIT">
<span class='line'>424</span>   </span><span class="NAME">willRemoveChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>425</span>   
<span class='line'>426</span>   </span><span class="COMM">/**
<span class='line'>427</span>     This method is called just after a child view is removed from the 
<span class='line'>428</span>     receiver's childNodes array.  You can use this to prepare for any layout 
<span class='line'>429</span>     or other cleanup you might need to do.
<span class='line'>430</span>     
<span class='line'>431</span>     The default implementation does nothing.
<span class='line'>432</span>     
<span class='line'>433</span>     @param child {SC.View} the view that was removed
<span class='line'>434</span>     @returns {void}
<span class='line'>435</span>   */</span><span class="WHIT">
<span class='line'>436</span>   </span><span class="NAME">didRemoveChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>437</span>   
<span class='line'>438</span>   
<span class='line'>439</span>   </span><span class="NAME">nextKeyView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>440</span>   </span><span class="NAME">previousKeyView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>441</span>   
<span class='line'>442</span>   </span><span class="NAME">nextValidKeyView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>443</span>   </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>444</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>445</span>     </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'nextKeyView'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>446</span>     </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>447</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'acceptsFirstResponder'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>448</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>449</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>450</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>451</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>452</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>453</span>   
<span class='line'>454</span>   </span><span class="NAME">previousValidKeyView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>455</span>   </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>456</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>457</span>     </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'previousKeyView'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>458</span>     </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>459</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'acceptsFirstResponder'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>460</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>461</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>462</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>463</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>464</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>465</span>   
<span class='line'>466</span>   </span><span class="COMM">/** @private 
<span class='line'>467</span>     Invoked whenever the child hierarchy changes and any internally cached 
<span class='line'>468</span>     values might need to be recalculated.       
<span class='line'>469</span>   */</span><span class="WHIT">
<span class='line'>470</span>   </span><span class="NAME">_flushInternalCaches</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>471</span>     </span><span class="COMM">// only flush cache for parent if this item was cached since the top level</span><span class="WHIT">
<span class='line'>472</span>     </span><span class="COMM">// cached can only be populated if this one is populated also...</span><span class="WHIT">
<span class='line'>473</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this._needsClippingFrame</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._needsFrameChanges</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>474</span>       </span><span class="NAME">this._needsClippingFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._needsFrameChanges</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>475</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.parentNode._flushInternalCaches</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>476</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>477</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>478</span>   
<span class='line'>479</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>480</span>   </span><span class="COMM">// SC.Responder implementation </span><span class="WHIT">
<span class='line'>481</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>482</span>   
<span class='line'>483</span>   </span><span class="NAME">nextResponder</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>484</span>   </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>485</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>486</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'parentNode'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>487</span>   
<span class='line'>488</span>   </span><span class="COMM">// recursively travels down the view hierarchy looking for a view that returns true to  performKeyEquivalent</span><span class="WHIT">
<span class='line'>489</span>   </span><span class="NAME">performKeyEquivalent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">keystring</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>490</span>   </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>491</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>492</span>     </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>493</span>     </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>494</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">child.performKeyEquivalent</span><span class="PUNC">(</span><span class="NAME">keystring</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>495</span>       </span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">child.get</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>496</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>497</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>498</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>499</span>   
<span class='line'>500</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>501</span>   </span><span class="COMM">// ELEMENT API</span><span class="WHIT">
<span class='line'>502</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>503</span> 
<span class='line'>504</span>   </span><span class="COMM">/**
<span class='line'>505</span>     An array of currently applied classNames.
<span class='line'>506</span>     
<span class='line'>507</span>     @field
<span class='line'>508</span>     @type {Array}
<span class='line'>509</span>     @param value {Array} Array of class names to apply to the element
<span class='line'>510</span>   */</span><span class="WHIT">
<span class='line'>511</span>   </span><span class="NAME">classNames</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>512</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>513</span>         </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.from</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>514</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.rootElement.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.join</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>515</span>         </span><span class="NAME">this._classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>516</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>517</span>     
<span class='line'>518</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._classNames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>519</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement.className</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>520</span>       </span><span class="NAME">this._classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">classNames</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">classNames.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">classNames.split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>521</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>522</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._classNames</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>523</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>524</span> 
<span class='line'>525</span>   </span><span class="COMM">/**
<span class='line'>526</span>     Detects the presence of the class name on the root element.
<span class='line'>527</span>     
<span class='line'>528</span>     @param className {String} the class name
<span class='line'>529</span>     @returns {Boolean} YES if class name is currently applied, NO otherwise
<span class='line'>530</span>   */</span><span class="WHIT">
<span class='line'>531</span>   </span><span class="NAME">hasClassName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>532</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._classNames</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>533</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>534</span> 
<span class='line'>535</span>   </span><span class="COMM">/**
<span class='line'>536</span>     Adds the class name to the element.
<span class='line'>537</span>     
<span class='line'>538</span>     @param className {String} the class name to add.
<span class='line'>539</span>     @returns {String} the class name
<span class='line'>540</span>   */</span><span class="WHIT">
<span class='line'>541</span>   </span><span class="NAME">addClassName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>542</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.hasClassName</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// nothing to do</span><span class="WHIT">
<span class='line'>543</span> 
<span class='line'>544</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._classNames</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>545</span>     </span><span class="NAME">classNames.push</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>546</span>     </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classNames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>547</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">className</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>548</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>549</span> 
<span class='line'>550</span>   </span><span class="COMM">/**
<span class='line'>551</span>     Removes the specified class name from the element.
<span class='line'>552</span>     
<span class='line'>553</span>     @param className {String} the class name to remove
<span class='line'>554</span>     @returns {String} the class name
<span class='line'>555</span>   */</span><span class="WHIT">
<span class='line'>556</span>   </span><span class="NAME">removeClassName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>557</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasClassName</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// nothing to do</span><span class="WHIT">
<span class='line'>558</span>     
<span class='line'>559</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._classNames</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>560</span>     </span><span class="NAME">classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">classNames.without</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>561</span>     </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classNames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">className</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>564</span> 
<span class='line'>565</span>   </span><span class="COMM">/**
<span class='line'>566</span>     Adds or removes the class name according to flag.
<span class='line'>567</span>     
<span class='line'>568</span>     This is a simple way to add or remove a class from the root element.
<span class='line'>569</span>     
<span class='line'>570</span>     @param className {String} the class name
<span class='line'>571</span>     @param flag {Boolean} YES to add class name, NO to remove it.
<span class='line'>572</span>     @returns {String} The class Name.
<span class='line'>573</span>   */</span><span class="WHIT">
<span class='line'>574</span>   </span><span class="NAME">setClassName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">flag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>575</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">flag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.addClassName</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.removeClassName</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>576</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>577</span> 
<span class='line'>578</span>   </span><span class="COMM">/**
<span class='line'>579</span>     Toggles the presence of the class name.
<span class='line'>580</span>     
<span class='line'>581</span>     If the specified CSS class is applied, it will be removed.  If it is not
<span class='line'>582</span>     present, it will be added.  Note that if this changes the potential 
<span class='line'>583</span>     layout of the view, you must wrap calls to this in viewFrameDidChange()
<span class='line'>584</span>     and viewFrameWillChange().
<span class='line'>585</span>     
<span class='line'>586</span>     @param className {String} the class name
<span class='line'>587</span>     @returns {Boolean} YES if classname is now applied
<span class='line'>588</span>   */</span><span class="WHIT">
<span class='line'>589</span>   </span><span class="NAME">toggleClassName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>590</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.setClassName</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.hasClassName</span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>591</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>592</span> 
<span class='line'>593</span>   </span><span class="COMM">/**
<span class='line'>594</span>     Retrieves the current value of the named CSS style.
<span class='line'>595</span>     
<span class='line'>596</span>     This method is designed to work cross platform and uses the current
<span class='line'>597</span>     computed style, which is the combination of all applied CSS class names
<span class='line'>598</span>     and inline styles.
<span class='line'>599</span>     
<span class='line'>600</span>     @param style {String} the style key.
<span class='line'>601</span>     @returns {Object} the style value or null if not-applied/auto
<span class='line'>602</span>   */</span><span class="WHIT">
<span class='line'>603</span>   </span><span class="NAME">getStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>604</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">element</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>605</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._computedStyle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>606</span>       </span><span class="NAME">this._computedStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.defaultView.getComputedStyle</span><span class="PUNC">(</span><span class="NAME">element</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>607</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>608</span> 
<span class='line'>609</span>     </span><span class="COMM">//if (style == 'float') style = 'cssFloat' ;</span><span class="WHIT">
<span class='line'>610</span>     </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'float'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'cssFloat'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">style.camelize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>611</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">element.style</span><span class="PUNC">[</span><span class="NAME">style</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>612</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>613</span>       </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._computedStyle</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._computedStyle</span><span class="PUNC">[</span><span class="NAME">style</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>614</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>615</span> 
<span class='line'>616</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'opacity'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>617</span>       </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1.0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>618</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>619</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'auto'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>620</span>     
<span class='line'>621</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>622</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>623</span>   
<span class='line'>624</span>   
<span class='line'>625</span>   </span><span class="COMM">/**
<span class='line'>626</span>     Sets the passed hash of CSS styles and values on the element.  You should
<span class='line'>627</span>     pass your properties pre-camelized.
<span class='line'>628</span>     
<span class='line'>629</span>     @param styles {Hash} hash of keys and values
<span class='line'>630</span>     @param camelized {Boolean} optional bool set to NO if you did not camelize.
<span class='line'>631</span>     @returns {Boolean} YES if set succeeded.
<span class='line'>632</span>   */</span><span class="WHIT">
<span class='line'>633</span>   </span><span class="NAME">setStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">styles</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">camelized</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>634</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Element.setStyle</span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">styles</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">camelized</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>635</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>636</span> 
<span class='line'>637</span> </span><span class="COMM">/**
<span class='line'>638</span>   Updates the HTML of an element.  
<span class='line'>639</span>   
<span class='line'>640</span>   This method takes care of nasties like processing scripts and inserting
<span class='line'>641</span>   HTML into a table.  It is also somewhat slow.  If you control the HTML 
<span class='line'>642</span>   being inserted and you are not working with table elements, you should use
<span class='line'>643</span>   the innerHTML property instead.  If you are setting content generated by
<span class='line'>644</span>   users, this method can insert the content safely.
<span class='line'>645</span>   
<span class='line'>646</span>   @param html {String} the html to insert.
<span class='line'>647</span> */</span><span class="WHIT">
<span class='line'>648</span>   </span><span class="NAME">update</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">html</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>649</span>     </span><span class="NAME">Element.update</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">html</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>650</span>     </span><span class="NAME">this.propertyDidChange</span><span class="PUNC">(</span><span class="STRN">'innerHTML'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>651</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>652</span> 
<span class='line'>653</span>   </span><span class="COMM">/**
<span class='line'>654</span>     Retrieves the value for an attribute on the DOM element
<span class='line'>655</span>     
<span class='line'>656</span>     @param attrName {String} the attribute name
<span class='line'>657</span>     @returns {String} attribute value
<span class='line'>658</span>   */</span><span class="WHIT">
<span class='line'>659</span>   </span><span class="NAME">getAttribute</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attrName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>660</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Element.readAttribute</span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">,</span><span class="NAME">attrName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>661</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>662</span> 
<span class='line'>663</span>   </span><span class="COMM">/**
<span class='line'>664</span>     Sets an attribute on the root DOM element.
<span class='line'>665</span>     
<span class='line'>666</span>     @param attrName {String} the attribute name
<span class='line'>667</span>     @param value {String} the new attribute value
<span class='line'>668</span>     @returns {String} the set attribute name
<span class='line'>669</span>   */</span><span class="WHIT">
<span class='line'>670</span>   </span><span class="NAME">setAttribute</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attrName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>671</span>     </span><span class="NAME">this.rootElement.setAttribute</span><span class="PUNC">(</span><span class="NAME">attrName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>672</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>673</span>   
<span class='line'>674</span>   </span><span class="COMM">/**
<span class='line'>675</span>     Returns true if the named attributes is defined on the views root element.
<span class='line'>676</span>     
<span class='line'>677</span>     @param attrName {String} the attribute name
<span class='line'>678</span>     @returns {Boolean} YES if attribute is present.
<span class='line'>679</span>   */</span><span class="WHIT">
<span class='line'>680</span>   </span><span class="NAME">hasAttribute</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attrName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>681</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Element.hasAttribute</span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attrName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>682</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>683</span> 
<span class='line'>684</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>685</span>   </span><span class="COMM">// STYLE API</span><span class="WHIT">
<span class='line'>686</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>687</span>   </span><span class="COMM">// These properties can be used to directly manipulate various CSS </span><span class="WHIT">
<span class='line'>688</span>   </span><span class="COMM">// styles on the view.  These properties are required for animation</span><span class="WHIT">
<span class='line'>689</span>   </span><span class="COMM">// support.  Values are typically assumed to be in px.</span><span class="WHIT">
<span class='line'>690</span>   
<span class='line'>691</span>   </span><span class="COMM">/**
<span class='line'>692</span>     SC.View's unknown property is used to implement a large class of 
<span class='line'>693</span>     properties beginning with the the world "style".  You can get or set
<span class='line'>694</span>     any of these properties to edit individual CSS style properties.
<span class='line'>695</span>   */</span><span class="WHIT">
<span class='line'>696</span>   </span><span class="NAME">unknownProperty</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>697</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">key.match</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">key.match</span><span class="PUNC">(</span><span class="REGX">/^style/</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>698</span>       </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">key.slice</span><span class="PUNC">(</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NAME">key.length</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/^./</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>699</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">x.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>700</span>       </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>701</span> 
<span class='line'>702</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span>       
<span class='line'>704</span>       </span><span class="COMM">// handle dimensional properties</span><span class="WHIT">
<span class='line'>705</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key.match</span><span class="PUNC">(</span><span class="REGX">/height$|width$|top$|bottom$|left$|right$/i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>706</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>707</span>           </span><span class="NAME">this.viewFrameWillChange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>708</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">props</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>709</span>           </span><span class="NAME">props</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'auto'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>710</span>           </span><span class="NAME">this.setStyle</span><span class="PUNC">(</span><span class="NAME">props</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>711</span>           </span><span class="NAME">this.viewFrameDidChange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>712</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>713</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>714</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'auto'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>715</span> 
<span class='line'>716</span>       </span><span class="COMM">// all other properties just pass through (and do not change frame)</span><span class="WHIT">
<span class='line'>717</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>718</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>719</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">props</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>720</span>           </span><span class="NAME">props</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>721</span>           </span><span class="NAME">this.setStyle</span><span class="PUNC">(</span><span class="NAME">props</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>722</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>723</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>724</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>725</span>       </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>726</span>       
<span class='line'>727</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">arguments.callee.base.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>728</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>729</span>   
<span class='line'>730</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>731</span>   </span><span class="COMM">// DOM API</span><span class="WHIT">
<span class='line'>732</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>733</span>   </span><span class="COMM">// The methods in this section give you some low-level control over how the</span><span class="WHIT">
<span class='line'>734</span>   </span><span class="COMM">// view interacts with the DOM.  You do not normally need to work with this.</span><span class="WHIT">
<span class='line'>735</span>   
<span class='line'>736</span>   </span><span class="COMM">/**
<span class='line'>737</span>     This is the DOM element actually managed by this view.  This will be set
<span class='line'>738</span>     by the view when it is created.  You should rarely need to access this 
<span class='line'>739</span>     property directly.  When you do access it, you should only do so from 
<span class='line'>740</span>     within methods you write on your SC.View subclasses, never from outside
<span class='line'>741</span>     the view.
<span class='line'>742</span>     
<span class='line'>743</span>     Unlike most properties, you do not need to use get()/set() to access this
<span class='line'>744</span>     property.  It is not currently safe to edit this property once the view
<span class='line'>745</span>     has been createde.
<span class='line'>746</span>     
<span class='line'>747</span>     @field
<span class='line'>748</span>     @type {Element}
<span class='line'>749</span>   */</span><span class="WHIT">
<span class='line'>750</span>   </span><span class="NAME">rootElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>751</span>   
<span class='line'>752</span>   </span><span class="COMM">/**
<span class='line'>753</span>     Normally when you add child views to your view, their DOM elements will
<span class='line'>754</span>     be set as direct children of the root element.  However you can
<span class='line'>755</span>     choose instead to designate an alertnative child node using this 
<span class='line'>756</span>     property.  Set this to a selector string to begin with.  The first time
<span class='line'>757</span>     it is accessed, the view will convert it to an actual element.  It is not
<span class='line'>758</span>     currently safe to edit this property once the view has been created.
<span class='line'>759</span>     
<span class='line'>760</span>     Like rootElement, you should only access this property from within
<span class='line'>761</span>     methods you write on an SC.View subclass, never from outside the view.
<span class='line'>762</span>     Unlike most properties, it is not necessary to use get()/set().
<span class='line'>763</span>     
<span class='line'>764</span>     @field
<span class='line'>765</span>     @type {Element}
<span class='line'>766</span>   */</span><span class="WHIT">
<span class='line'>767</span>   </span><span class="NAME">containerElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>768</span> 
<span class='line'>769</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>770</span>   </span><span class="COMM">// VIEW LAYOUT</span><span class="WHIT">
<span class='line'>771</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>772</span>   </span><span class="COMM">// The following methods can be used to implement automatic resizing.</span><span class="WHIT">
<span class='line'>773</span>   </span><span class="COMM">// The frame and bounds provides a simple way for you to compute the </span><span class="WHIT">
<span class='line'>774</span>   </span><span class="COMM">// location and size of your views.  You can then use the automatic</span><span class="WHIT">
<span class='line'>775</span>   </span><span class="COMM">// resizing.</span><span class="WHIT">
<span class='line'>776</span>   
<span class='line'>777</span>   </span><span class="COMM">/**
<span class='line'>778</span>     Returns true if the view or any of its contained views implement the
<span class='line'>779</span>     clippingFrameDidChange method.
<span class='line'>780</span>     
<span class='line'>781</span>     If this property returns false, then notifications about changes to the 
<span class='line'>782</span>     clippingFrame will probably not be called on the receiver.  Normally if 
<span class='line'>783</span>     you do not need to worry about this property since implementing the 
<span class='line'>784</span>     clippingFrameDidChange() method will change its value and cause your 
<span class='line'>785</span>     method to be invoked.
<span class='line'>786</span>     
<span class='line'>787</span>     This property is automatically updated whenever you add or remove a child 
<span class='line'>788</span>     view.
<span class='line'>789</span>   */</span><span class="WHIT">
<span class='line'>790</span>   </span><span class="NAME">needsClippingFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>791</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._needsClippingFrame</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>792</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.clippingFrameDidChange</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">SC.View.prototype.clippingFrameDidChange</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>793</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>794</span>       </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>795</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'needsClippingFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>796</span>         </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>797</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>798</span>       </span><span class="NAME">this._needsClippingFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>799</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>800</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._needsClippingFrame</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>801</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>802</span>   
<span class='line'>803</span>   </span><span class="COMM">/**
<span class='line'>804</span>     Returns true if the view or any of its contained views implements any 
<span class='line'>805</span>     resize methods.
<span class='line'>806</span>     
<span class='line'>807</span>     If this property returns false, changes to your frame view may not be 
<span class='line'>808</span>     relayed to child methods.  This may mean that your various frame 
<span class='line'>809</span>     properties could become stale unless you call refreshFrames() first.
<span class='line'>810</span> 
<span class='line'>811</span>     If you want you make sure your frames are up to date, see hasManualLayout.
<span class='line'>812</span>     
<span class='line'>813</span>     This property is automatically updated whenever you add or remove a child 
<span class='line'>814</span>     view.  It returns true if you implement any of the resize methods or if 
<span class='line'>815</span>     hasManualLayout is true.
<span class='line'>816</span>   */</span><span class="WHIT">
<span class='line'>817</span>   </span><span class="NAME">needsFrameChanges</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>818</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._needsFrameChanges</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT">   </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>819</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'needsClippingFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'hasManualLayout'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>820</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>821</span>       </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>822</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'needsFrameChanges'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>823</span>         </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>824</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>825</span>       </span><span class="NAME">this._needsFrameChanges</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>826</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>827</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._needsFrameChanges</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>828</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>829</span>   
<span class='line'>830</span> 
<span class='line'>831</span>   </span><span class="COMM">/**
<span class='line'>832</span>     Returns true if the receiver manages the layout for itself or its 
<span class='line'>833</span>     children.
<span class='line'>834</span>     
<span class='line'>835</span>     Normally this property returns true automatically if you implement
<span class='line'>836</span>     resizeChildrenWithOldSize() or resizeWithOldParentSize() or 
<span class='line'>837</span>     clippingFrameDidChange().
<span class='line'>838</span>     
<span class='line'>839</span>     If you do not implement these methods but need to make sure your frame is 
<span class='line'>840</span>     always up-to-date anyway, set this property to true.
<span class='line'>841</span>   */</span><span class="WHIT">
<span class='line'>842</span>   </span><span class="NAME">hasManualLayout</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>843</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.resizeChildrenWithOldSize</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">SC.View.prototype.resizeChildrenWithOldSize</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>844</span>     </span><span class="PUNC">(</span><span class="NAME">this.resizeWithOldParentSize</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">SC.View.prototype.resizeWithOldParentSize</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>845</span>     </span><span class="PUNC">(</span><span class="NAME">this.clippingFrameDidChange</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">SC.View.prototype.clippingFrameDidChange</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>846</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>847</span>     
<span class='line'>848</span>   </span><span class="COMM">/**
<span class='line'>849</span>     Convert a point _from_ the offset parent of the passed view to the current 
<span class='line'>850</span>     view.
<span class='line'>851</span> 
<span class='line'>852</span>     This is a useful utility for converting points in the coordinate system of
<span class='line'>853</span>     another view to the coordinate system of the receiver. Pass null for 
<span class='line'>854</span>     targetView to convert a point from a window offset.  This is the inverse 
<span class='line'>855</span>     of convertFrameToView().
<span class='line'>856</span>     
<span class='line'>857</span>     Note that if your view is not visible on the screen, this may not work.
<span class='line'>858</span>     
<span class='line'>859</span>     @param {Point} f The point or frame to convert
<span class='line'>860</span>     @param {SC.View} targetView The view to convert from.  Pass null to convert from window coordinates.
<span class='line'>861</span>       
<span class='line'>862</span>     @returns {Point} The converted point or frame
<span class='line'>863</span>   */</span><span class="WHIT">
<span class='line'>864</span>   </span><span class="NAME">convertFrameFromView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">targetView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>865</span>     
<span class='line'>866</span>     </span><span class="COMM">// first, convert to root level offset.</span><span class="WHIT">
<span class='line'>867</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisOffset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.viewportOffset</span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'offsetParent'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>868</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thatOffset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">targetView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">SC.viewportOffset</span><span class="PUNC">(</span><span class="NAME">targetView.get</span><span class="PUNC">(</span><span class="STRN">'offsetParent'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.ZERO_POINT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>869</span>     
<span class='line'>870</span>     </span><span class="COMM">// now get adjustment.</span><span class="WHIT">
<span class='line'>871</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">adjustX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">thatOffset.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">thisOffset.x</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>872</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">adjustY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">thatOffset.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">thisOffset.y</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>873</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">adjustX</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">adjustY</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>874</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>875</span>   
<span class='line'>876</span>   </span><span class="COMM">/**
<span class='line'>877</span>     Convert a point _to_ the offset parent of the passed view from the current 
<span class='line'>878</span>     view.
<span class='line'>879</span> 
<span class='line'>880</span>     This is a useful utility for converting points in the coordinate system of
<span class='line'>881</span>     the receiver to the coordinate system of another view. Pass null for 
<span class='line'>882</span>     targetView to convert a point to a window offset.  This is the inverse of 
<span class='line'>883</span>     convertFrameFromView().
<span class='line'>884</span>     
<span class='line'>885</span>     Note that if your view is not visible on the screen, this may not work.
<span class='line'>886</span>     
<span class='line'>887</span>     @param {Point} f The point or frame to convert
<span class='line'>888</span>     @param {SC.View} targetView The view to convert to.  Pass null to convert to window coordinates.
<span class='line'>889</span>       
<span class='line'>890</span>     @returns {Point} The converted point or frame
<span class='line'>891</span>   */</span><span class="WHIT">
<span class='line'>892</span>   </span><span class="NAME">convertFrameToView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sourceView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>893</span>     </span><span class="COMM">// first, convert to root level offset.</span><span class="WHIT">
<span class='line'>894</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisOffset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.viewportOffset</span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'offsetParent'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>895</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thatOffset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sourceView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">SC.viewportOffset</span><span class="PUNC">(</span><span class="NAME">sourceView.get</span><span class="PUNC">(</span><span class="STRN">'offsetParent'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.ZERO_POINT</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>896</span>     
<span class='line'>897</span>     </span><span class="COMM">// now get adjustment.</span><span class="WHIT">
<span class='line'>898</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">adjustX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">thisOffset.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">thatOffset.x</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>899</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">adjustY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">thisOffset.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">thatOffset.y</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>900</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">adjustX</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">adjustY</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>901</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>902</span> 
<span class='line'>903</span>   </span><span class="COMM">/**
<span class='line'>904</span>     This property returns a DOM ELEMENT that is the offset parent for
<span class='line'>905</span>     this view's frame coordinates.  Depending on your CSS, this parent
<span class='line'>906</span>     may or may not match with the parent view.
<span class='line'>907</span>     
<span class='line'>908</span>     @example
<span class='line'>909</span>     offsetView = $view(this.get('offsetParent')) ;
<span class='line'>910</span>     
<span class='line'>911</span>     @field
<span class='line'>912</span>     @type {Element}
<span class='line'>913</span>   */</span><span class="WHIT">
<span class='line'>914</span>   </span><span class="NAME">offsetParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>915</span>     
<span class='line'>916</span>     </span><span class="COMM">// handle simple cases.</span><span class="WHIT">
<span class='line'>917</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>918</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">el</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>919</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.offsetParent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">el.offsetParent</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>920</span> 
<span class='line'>921</span>     </span><span class="COMM">// in some cases, we can't find the offset parent so we walk up the </span><span class="WHIT">
<span class='line'>922</span>     </span><span class="COMM">// chain until an element is found with a position other than</span><span class="WHIT">
<span class='line'>923</span>     </span><span class="COMM">// 'static'</span><span class="WHIT">
<span class='line'>924</span>     </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>925</span>     </span><span class="COMM">// Note that IE places DOM elements not in the main body inside of a </span><span class="WHIT">
<span class='line'>926</span>     </span><span class="COMM">// document-fragment root.  We need to treat document-fragments (i.e. </span><span class="WHIT">
<span class='line'>927</span>     </span><span class="COMM">// nodeType === 11) as null values</span><span class="WHIT">
<span class='line'>928</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>929</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.nodeType</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NUMB">11</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>930</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Element.getStyle</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'position'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'static'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>931</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>932</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>933</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>934</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>935</span> 
<span class='line'>936</span>   </span><span class="COMM">/**
<span class='line'>937</span>     The inner bounds for the content shown inside of this frame.  Reflects 
<span class='line'>938</span>     scroll position and other properties.
<span class='line'>939</span> 
<span class='line'>940</span>     The inner frame returns the actual available frame for child elements, 
<span class='line'>941</span>     less any borders or scroll bars. 
<span class='line'>942</span>     
<span class='line'>943</span>     This value can change when:
<span class='line'>944</span>     - the receiver's frame changes
<span class='line'>945</span>     - the receiver's child views change, adding or removing scrollbars
<span class='line'>946</span>     - You can the CSS or applied style that effects the borders or scrollbar visibility
<span class='line'>947</span>   */</span><span class="WHIT">
<span class='line'>948</span>   </span><span class="NAME">innerFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>949</span>     
<span class='line'>950</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>951</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._innerFrame</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">  
<span class='line'>952</span> 
<span class='line'>953</span>       </span><span class="COMM">// get the base frame</span><span class="WHIT">
<span class='line'>954</span>       </span><span class="COMM">// The _collectInnerFrame function is set at the bottom of this file</span><span class="WHIT">
<span class='line'>955</span>       </span><span class="COMM">// based on the browser type.</span><span class="WHIT">
<span class='line'>956</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>957</span>       </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._collectFrame</span><span class="PUNC">(</span><span class="NAME">SC.View._collectInnerFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>958</span> 
<span class='line'>959</span>       </span><span class="COMM">// bizarely for FireFox if your offsetParent has a border, then it can </span><span class="WHIT">
<span class='line'>960</span>       </span><span class="COMM">// impact the offset</span><span class="WHIT">
<span class='line'>961</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.Platform.Firefox</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>962</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.offsetParent</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>963</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">overflow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">Element.getStyle</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'overflow'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'visible'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>964</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">overflow</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">overflow</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'visible'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>965</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">Element.getStyle</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderLeftWidth'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>966</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">Element.getStyle</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderTopWidth'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>967</span>           </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>968</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>969</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>970</span>       
<span class='line'>971</span>       </span><span class="COMM">// fix the x & y with the clientTop/clientLeft</span><span class="WHIT">
<span class='line'>972</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">clientLeft</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">clientTop</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>973</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.clientLeft</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>974</span>         </span><span class="NAME">clientLeft</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="STRN">'border-left-width'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>975</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">clientLeft</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.clientLeft</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>976</span> 
<span class='line'>977</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.clientTop</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>978</span>         </span><span class="NAME">clientTop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="STRN">'border-top-width'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>979</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">clientTop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.clientTop</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>980</span> 
<span class='line'>981</span>       </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">clientLeft</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">clientTop</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>982</span>       
<span class='line'>983</span>       </span><span class="COMM">// cache this frame if using manual layout mode</span><span class="WHIT">
<span class='line'>984</span>       </span><span class="NAME">this._innerFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>985</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">this._innerFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>986</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>987</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>988</span> 
<span class='line'>989</span>   </span><span class="COMM">/** 
<span class='line'>990</span>     The outside bounds of your view, offset top/left from its offsetParent
<span class='line'>991</span> 
<span class='line'>992</span>     The frame rect is the area actually occupied by a view including any
<span class='line'>993</span>     borders or padding, but excluding margins.  
<span class='line'>994</span>     
<span class='line'>995</span>     The frame is calculated and cached the first time you get it.  Afer that, 
<span class='line'>996</span>     the frame cache should automatically update when you make changes that 
<span class='line'>997</span>     will effect the view frames unless you change the frame indirectly, such 
<span class='line'>998</span>     as through changing CSS classes or by-passing the view to edit the DOM.
<span class='line'>999</span> 
<span class='line'>1000</span>     If you make a change like this, be sure to wrap the code that makes this
<span class='line'>1001</span>     change with calls to viewFrameWillChange() and viewFrameDidChange() on the
<span class='line'>1002</span>     highest-level view that will be impacted by the change.  Calling this
<span class='line'>1003</span>     method will automatically update child frames as well.
<span class='line'>1004</span>     
<span class='line'>1005</span>     When you set the frame property, it will update the left, top, height,
<span class='line'>1006</span>     and width CSS attributes on the element.  Since the height and width in
<span class='line'>1007</span>     the frame rect includes borders and padding, the view will automatically
<span class='line'>1008</span>     adjust the height and width CSS it sets to account for this.  
<span class='line'>1009</span> 
<span class='line'>1010</span>     If you would prefer to edit the CSS attributes for the frame directly
<span class='line'>1011</span>     instead, you can do so by using the styleTop, styleLeft, styleRight, 
<span class='line'>1012</span>     styleBottom, styleWidth, and styleHeight properties on the view.  These
<span class='line'>1013</span>     properties will update the CSS attributes and call viewFrameDidChange()/
<span class='line'>1014</span>     viewFrameWillChange().
<span class='line'>1015</span> 
<span class='line'>1016</span>     @field
<span class='line'>1017</span>   */</span><span class="WHIT">
<span class='line'>1018</span>   </span><span class="NAME">frame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1019</span> 
<span class='line'>1020</span>     </span><span class="COMM">// if value was passed, set the values in the style</span><span class="WHIT">
<span class='line'>1021</span>     </span><span class="COMM">// now update the frame if needed.  Only actually change the style for</span><span class="WHIT">
<span class='line'>1022</span>     </span><span class="COMM">// those parts of the frame that were passed in.</span><span class="WHIT">
<span class='line'>1023</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1024</span>       
<span class='line'>1025</span>       </span><span class="NAME">this.viewFrameWillChange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1026</span>       
<span class='line'>1027</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1028</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1029</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">didResize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1030</span> 
<span class='line'>1031</span>       </span><span class="COMM">// collect required info </span><span class="WHIT">
<span class='line'>1032</span>       </span><span class="COMM">// reposition X</span><span class="WHIT">
<span class='line'>1033</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value.x</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1034</span>         </span><span class="NAME">style.left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1035</span>         </span><span class="NAME">style.right</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'auto'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1036</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1037</span> 
<span class='line'>1038</span>       </span><span class="COMM">// reposition Y</span><span class="WHIT">
<span class='line'>1039</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value.y</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1040</span>         </span><span class="NAME">style.top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1041</span>         </span><span class="NAME">style.bottom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'auto'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1042</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1043</span>       
<span class='line'>1044</span>       </span><span class="COMM">// Resize width</span><span class="WHIT">
<span class='line'>1045</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value.width</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1046</span>         </span><span class="NAME">didResize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1047</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">padding</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1048</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.View.WIDTH_PADDING_STYLES.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1049</span>         </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1050</span>           </span><span class="NAME">padding</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="NAME">SC.View.WIDTH_PADDING_STYLES</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1051</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1052</span>         </span><span class="NAME">style.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">padding</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1053</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1054</span>       
<span class='line'>1055</span>       </span><span class="COMM">// Resize Height</span><span class="WHIT">
<span class='line'>1056</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value.height</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1057</span>         </span><span class="NAME">didResize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1058</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">padding</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1059</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.View.HEIGHT_PADDING_STYLES.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1060</span>         </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1061</span>           </span><span class="NAME">padding</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="NAME">SC.View.HEIGHT_PADDING_STYLES</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1062</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1063</span>         </span><span class="NAME">style.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">padding</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1064</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1065</span> 
<span class='line'>1066</span>       </span><span class="COMM">// now apply style change and clear the cached frame</span><span class="WHIT">
<span class='line'>1067</span>       </span><span class="NAME">this.setStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1068</span>       
<span class='line'>1069</span>       </span><span class="COMM">// notify for a resize only.</span><span class="WHIT">
<span class='line'>1070</span>       </span><span class="NAME">this.viewFrameDidChange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1071</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1072</span>     
<span class='line'>1073</span>     </span><span class="COMM">// build frame.  We can use a cached version but only </span><span class="WHIT">
<span class='line'>1074</span>     </span><span class="COMM">// if layoutMode == SC.MANUAL_MODE</span><span class="WHIT">
<span class='line'>1075</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1076</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._frame</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1077</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1078</span>       </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._collectFrame</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1079</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>1080</span>           </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetLeft</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>1081</span>           </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetTop</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>1082</span>           </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetWidth</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>1083</span>           </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetHeight</span><span class="WHIT"> 
<span class='line'>1084</span>         </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1085</span>       </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1086</span>       
<span class='line'>1087</span>       </span><span class="COMM">// bizarely for FireFox if your offsetParent has a border, then it can </span><span class="WHIT">
<span class='line'>1088</span>       </span><span class="COMM">// impact the offset</span><span class="WHIT">
<span class='line'>1089</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.Platform.Firefox</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1090</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.offsetParent</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1091</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">overflow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">Element.getStyle</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'overflow'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'visible'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1092</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">overflow</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">overflow</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'visible'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1093</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">Element.getStyle</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderLeftWidth'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1094</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">Element.getStyle</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderTopWidth'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1095</span>           </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1096</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1097</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1098</span>       
<span class='line'>1099</span>       </span><span class="COMM">// cache this frame if using manual layout mode</span><span class="WHIT">
<span class='line'>1100</span>       </span><span class="NAME">this._frame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1101</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">this._frame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1102</span> 
<span class='line'>1103</span>     </span><span class="COMM">// finally return the frame. </span><span class="WHIT">
<span class='line'>1104</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1105</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1106</span>   
<span class='line'>1107</span>   </span><span class="COMM">/**
<span class='line'>1108</span>     The current frame size.
<span class='line'>1109</span>     
<span class='line'>1110</span>     This property will actually return the same value as the frame property, 
<span class='line'>1111</span>     however setting this property will set only the frame size and ignore any 
<span class='line'>1112</span>     origin you might pass.
<span class='line'>1113</span>     
<span class='line'>1114</span>     @field
<span class='line'>1115</span>   */</span><span class="WHIT">
<span class='line'>1116</span>   </span><span class="NAME">size</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1117</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1118</span>       </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">value.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">value.height</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1119</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1120</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1121</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1122</span>   
<span class='line'>1123</span>   </span><span class="COMM">/**
<span class='line'>1124</span>     The current frame origin.
<span class='line'>1125</span>     
<span class='line'>1126</span>     This property will actually return the same value as the frame property, 
<span class='line'>1127</span>     however setting this property will set only the frame origin and ignore 
<span class='line'>1128</span>     any size you might pass.
<span class='line'>1129</span>     
<span class='line'>1130</span>     @field
<span class='line'>1131</span>   */</span><span class="WHIT">
<span class='line'>1132</span>   </span><span class="NAME">origin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1133</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1134</span>       </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">value.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">value.y</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1135</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1136</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1137</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1138</span>   
<span class='line'>1139</span>   </span><span class="COMM">/**
<span class='line'>1140</span>     Call this method before you make a change that will impact the frame of 
<span class='line'>1141</span>     the view such as changing the border thickness or adding/removing a CSS 
<span class='line'>1142</span>     style.
<span class='line'>1143</span>     
<span class='line'>1144</span>     Once you finish making your changes, be sure to call viewFrameDidChange() 
<span class='line'>1145</span>     as well. This will deliver any relevant resizing and other notifications.  
<span class='line'>1146</span>     It is safe to nest multiple calls to this method.
<span class='line'>1147</span>     
<span class='line'>1148</span>     This method is called automatically anytime you set the frame.
<span class='line'>1149</span>     
<span class='line'>1150</span>     @returns {void}
<span class='line'>1151</span>   */</span><span class="WHIT">
<span class='line'>1152</span>   </span><span class="NAME">viewFrameWillChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1153</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._frameChangeLevel</span><span class="PUNC">++</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1154</span>       </span><span class="NAME">this._frameChangeLevel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1155</span> 
<span class='line'>1156</span>       </span><span class="COMM">// save frame information if view has manual layout.</span><span class="WHIT">
<span class='line'>1157</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'needsFrameChanges'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1158</span>         </span><span class="NAME">this._cachedFrames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getEach</span><span class="PUNC">(</span><span class="STRN">'innerFrame'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'clippingFrame'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1159</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this._cachedFrames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1160</span>       </span><span class="NAME">this.beginPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// suspend change notifications</span><span class="WHIT">
<span class='line'>1161</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1162</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1163</span> 
<span class='line'>1164</span>   </span><span class="COMM">/**
<span class='line'>1165</span>     Call this method just after you finish making changes that will impace the 
<span class='line'>1166</span>     frame of the view such as changing the border thickness or adding/removing 
<span class='line'>1167</span>     a CSS style.
<span class='line'>1168</span>     
<span class='line'>1169</span>     It is safe to next multiple calls to this method.   This method is called 
<span class='line'>1170</span>     automatically anytime you set the frame.
<span class='line'>1171</span>     
<span class='line'>1172</span>     @returns {void}
<span class='line'>1173</span>   */</span><span class="WHIT">
<span class='line'>1174</span>   </span><span class="NAME">viewFrameDidChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1175</span>     
<span class='line'>1176</span>     </span><span class="COMM">// clear the frame caches</span><span class="WHIT">
<span class='line'>1177</span>     </span><span class="NAME">this.recacheFrames</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1178</span> 
<span class='line'>1179</span>     </span><span class="COMM">// if this is a top-level call then also deliver notifications as needed.</span><span class="WHIT">
<span class='line'>1180</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">this._frameChangeLevel</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1181</span>       </span><span class="NAME">this._frameChangeLevel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1182</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._cachedFrames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1183</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newFrames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getEach</span><span class="PUNC">(</span><span class="STRN">'innerFrame'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'clippingFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1184</span>         
<span class='line'>1185</span>         </span><span class="COMM">// notify if clippingFrame has changed and clippingFrameDidChange is </span><span class="WHIT">
<span class='line'>1186</span>         </span><span class="COMM">// implemented.</span><span class="WHIT">
<span class='line'>1187</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newFrames</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._cachedFrames</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1188</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nf.width</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">of.width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nf.height</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">of.height</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1189</span>           </span><span class="NAME">this._invalidateClippingFrame</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1190</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1191</span> 
<span class='line'>1192</span>         </span><span class="COMM">// notify children if the size of the innerFrame has changed.</span><span class="WHIT">
<span class='line'>1193</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newFrames</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._cachedFrames</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1194</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nf.width</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">of.width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nf.height</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">of.height</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1195</span>           </span><span class="NAME">this.resizeChildrenWithOldSize</span><span class="PUNC">(</span><span class="NAME">this._cachedFrames.last</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">          
<span class='line'>1196</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1197</span>         
<span class='line'>1198</span>         </span><span class="COMM">// clear parent scrollFrame if needed</span><span class="WHIT">
<span class='line'>1199</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.parentNode</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1200</span>         </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">SC.window</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1201</span>           </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent._scrollFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">parent._scrollFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1202</span>           </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent.parentNode</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1203</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1204</span>         
<span class='line'>1205</span>         </span><span class="NAME">this.notifyPropertyChange</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// trigger notifications.</span><span class="WHIT">
<span class='line'>1206</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1207</span>       
<span class='line'>1208</span>       </span><span class="COMM">// allow notifications again</span><span class="WHIT">
<span class='line'>1209</span>       </span><span class="NAME">this.endPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1210</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1211</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1212</span> 
<span class='line'>1213</span> 
<span class='line'>1214</span>   </span><span class="COMM">/**
<span class='line'>1215</span>     Clears any cached frames so the next get will recompute them.
<span class='line'>1216</span>     
<span class='line'>1217</span>     This method does not notify any observers of changes to the frames.  It 
<span class='line'>1218</span>     should only be used when you need to make sure your frame info is up to 
<span class='line'>1219</span>     date but you do not expect anything to have happened that frame observers 
<span class='line'>1220</span>     would be interested in.
<span class='line'>1221</span>   */</span><span class="WHIT">
<span class='line'>1222</span>   </span><span class="NAME">recacheFrames</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1223</span>     </span><span class="NAME">this._innerFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._frame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clippingFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._scrollFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1224</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1225</span>   
<span class='line'>1226</span>   </span><span class="COMM">/**
<span class='line'>1227</span>     Set to true if you expect this view to have scrollable content.
<span class='line'>1228</span> 
<span class='line'>1229</span>     Normally views do not monitor their onscroll event.  If you set this 
<span class='line'>1230</span>     property to true, however, the view will observe its onscroll event and 
<span class='line'>1231</span>     update its scrollFrame and clippedFrame.
<span class='line'>1232</span> 
<span class='line'>1233</span>     This will also register the view as a scrollable area that can be 
<span class='line'>1234</span>     auto-scrolled during a drag/drop event.
<span class='line'>1235</span>   */</span><span class="WHIT">
<span class='line'>1236</span>   </span><span class="NAME">isScrollable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1237</span>   
<span class='line'>1238</span>   </span><span class="COMM">/**
<span class='line'>1239</span>     The frame used to control scrolling of content.
<span class='line'>1240</span>     
<span class='line'>1241</span>     x,y => offset from the innerFrame root.
<span class='line'>1242</span>     width,height => total size of the frame
<span class='line'>1243</span>     
<span class='line'>1244</span>     If the frame does not have scrollable content, then the size will be equal 
<span class='line'>1245</span>     to the innerFrame size.
<span class='line'>1246</span> 
<span class='line'>1247</span>     This frame changes when:
<span class='line'>1248</span>     - the receiver's innerFrame changes
<span class='line'>1249</span>     - the scroll location is changed programatically
<span class='line'>1250</span>     - the size of child views changes
<span class='line'>1251</span>     - the user scrolls the view
<span class='line'>1252</span>     
<span class='line'>1253</span>     @field
<span class='line'>1254</span>   */</span><span class="WHIT">
<span class='line'>1255</span>   </span><span class="NAME">scrollFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">  
<span class='line'>1256</span> 
<span class='line'>1257</span>     </span><span class="COMM">// if value was passed, update the scroll x,y only.</span><span class="WHIT">
<span class='line'>1258</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1259</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1260</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value.x</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">el.scrollLeft</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">-</span><span class="NAME">value.x</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1261</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value.y</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">el.scrollTop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">-</span><span class="NAME">value.y</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1262</span>       </span><span class="NAME">this._scrollFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1263</span>       </span><span class="NAME">this._invalidateClippingFrame</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1264</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1265</span>     
<span class='line'>1266</span>     </span><span class="COMM">// build frame.  We can use a cached version but only </span><span class="WHIT">
<span class='line'>1267</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1268</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._scrollFrame</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1269</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1270</span>       </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._collectFrame</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1271</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>1272</span>           </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">el.scrollLeft</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>1273</span>           </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">el.scrollTop</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>1274</span>           </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.scrollWidth</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>1275</span>           </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.scrollHeight</span><span class="WHIT"> 
<span class='line'>1276</span>         </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1277</span>       </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1278</span>       
<span class='line'>1279</span>       </span><span class="COMM">// cache this frame if using manual layout mode</span><span class="WHIT">
<span class='line'>1280</span>       </span><span class="NAME">this._scrollFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1281</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">this._scrollFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1282</span> 
<span class='line'>1283</span>     </span><span class="COMM">// finally return the frame. </span><span class="WHIT">
<span class='line'>1284</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1285</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1286</span>   
<span class='line'>1287</span>   </span><span class="COMM">/**
<span class='line'>1288</span>     The visible portion of the view.
<span class='line'>1289</span> 
<span class='line'>1290</span>     Returns the subset of the receivers frame that is actually visible on
<span class='line'>1291</span>     screen. This frame is automatically updated whenever one of the following 
<span class='line'>1292</span>     changes:
<span class='line'>1293</span>     
<span class='line'>1294</span>     - A parent view is resized
<span class='line'>1295</span>     - A parent view's scrollFrame changes.
<span class='line'>1296</span>     - The receiver is moved or resized
<span class='line'>1297</span>     - The receiver or a parent view is added to or removed from the window.
<span class='line'>1298</span>     
<span class='line'>1299</span>     @field
<span class='line'>1300</span>   */</span><span class="WHIT">
<span class='line'>1301</span>   </span><span class="NAME">clippingFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1302</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1303</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._clippingFrame</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1304</span> 
<span class='line'>1305</span>       </span><span class="COMM">//if (this instanceof SC.SplitView) debugger ;</span><span class="WHIT">
<span class='line'>1306</span>       
<span class='line'>1307</span>       </span><span class="COMM">// my clipping frame is usually my frame</span><span class="WHIT">
<span class='line'>1308</span>       </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1309</span>       
<span class='line'>1310</span>       </span><span class="COMM">// scope to my parents clipping frame.</span><span class="WHIT">
<span class='line'>1311</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1312</span>         
<span class='line'>1313</span>         </span><span class="COMM">// use only the visible portion of the parent's innerFrame.</span><span class="WHIT">
<span class='line'>1314</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.parentNode</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1315</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">prect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.intersectRects</span><span class="PUNC">(</span><span class="NAME">parent.get</span><span class="PUNC">(</span><span class="STRN">'clippingFrame'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent.get</span><span class="PUNC">(</span><span class="STRN">'innerFrame'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1316</span> 
<span class='line'>1317</span>         </span><span class="COMM">// convert the local view's coordinates</span><span class="WHIT">
<span class='line'>1318</span>         </span><span class="NAME">prect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.convertFrameFromView</span><span class="PUNC">(</span><span class="NAME">prect</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1319</span> 
<span class='line'>1320</span>         </span><span class="COMM">// if parent is scrollable, then adjust by scroll frame also.</span><span class="WHIT">
<span class='line'>1321</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.parentNode.get</span><span class="PUNC">(</span><span class="STRN">'isScrollable'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1322</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">scrollFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'scrollFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1323</span>           </span><span class="NAME">prect.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scrollFrame.x</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1324</span>           </span><span class="NAME">prect.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scrollFrame.y</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1325</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1326</span> 
<span class='line'>1327</span>         </span><span class="COMM">// blend with current frame</span><span class="WHIT">
<span class='line'>1328</span>         </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.intersectRects</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prect</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1329</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1330</span>         </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1331</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1332</span>       
<span class='line'>1333</span>       </span><span class="NAME">this._clippingFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1334</span> 
<span class='line'>1335</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.cloneRect</span><span class="PUNC">(</span><span class="NAME">this._clippingFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1336</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1337</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'scrollFrame'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1338</span>   
<span class='line'>1339</span>   </span><span class="COMM">/**
<span class='line'>1340</span>     Called whenever the receivers clippingFrame has changed.  You can override 
<span class='line'>1341</span>     this method to perform partial rendering or other clippingFrame-dependent 
<span class='line'>1342</span>     actions.
<span class='line'>1343</span>     
<span class='line'>1344</span>     The default implementation does nothing (and may not even be called do to 
<span class='line'>1345</span>     optimizations).  Note that this is the preferred way to respond to changes 
<span class='line'>1346</span>     in the clippingFrame of using an observer since this method is gauranteed 
<span class='line'>1347</span>     to happen in the correct order.  You can use observers and bindings as 
<span class='line'>1348</span>     well if you wish to handle anything that need not be handled 
<span class='line'>1349</span>     synchronously.
<span class='line'>1350</span>   */</span><span class="WHIT">
<span class='line'>1351</span>   </span><span class="NAME">clippingFrameDidChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1352</span>     
<span class='line'>1353</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1354</span>   
<span class='line'>1355</span>   </span><span class="COMM">/**
<span class='line'>1356</span>     Called whenever the view's innerFrame size changes.  You can override this 
<span class='line'>1357</span>     method to perform your own layout of your child views.  
<span class='line'>1358</span>     
<span class='line'>1359</span>     If you do not override this method, the view will assume you are using 
<span class='line'>1360</span>     CSS to layout your child views.  As an optimization the view may not 
<span class='line'>1361</span>     always call this method if it determines that you have not overridden it.
<span class='line'>1362</span>     
<span class='line'>1363</span>     This default version simply calls resizeWithOldParentSize() on all of its
<span class='line'>1364</span>     children.
<span class='line'>1365</span>     
<span class='line'>1366</span>     @param oldSize {Size} The old frame size of the view.
<span class='line'>1367</span>     @returns {void}
<span class='line'>1368</span>   */</span><span class="WHIT">
<span class='line'>1369</span>   </span><span class="NAME">resizeChildrenWithOldSize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">oldSize</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1370</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1371</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1372</span>       </span><span class="NAME">child.resizeWithOldParentSize</span><span class="PUNC">(</span><span class="NAME">oldSize</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1373</span>       </span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">child.get</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1374</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1375</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1376</span> 
<span class='line'>1377</span>   </span><span class="COMM">/**
<span class='line'>1378</span>     Called whenever the parent's innerFrame size has changed.  You can 
<span class='line'>1379</span>     override this method to change how your view responds to this change.
<span class='line'>1380</span>     
<span class='line'>1381</span>     If you do not override this method, the view will assume you are using CSS 
<span class='line'>1382</span>     to control your layout and it will simply relay the change information to 
<span class='line'>1383</span>     your child views.  As an optmization, the view may not always call this 
<span class='line'>1384</span>     method if it determines that you have not overridden it.
<span class='line'>1385</span>     
<span class='line'>1386</span>     @param oldSize {Size} The old frame size of the parent view.
<span class='line'>1387</span>   */</span><span class="WHIT">
<span class='line'>1388</span>   </span><span class="NAME">resizeWithOldParentSize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">oldSize</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1389</span>     </span><span class="NAME">this.viewFrameWillChange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1390</span>     </span><span class="NAME">this.viewFrameDidChange</span><span class="PUNC">(</span><span class="NAME">YES</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1391</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1392</span>   
<span class='line'>1393</span>   </span><span class="COMM">/** @private
<span class='line'>1394</span>     Handler for the onscroll event.  Hooked in on init if isScrollable is 
<span class='line'>1395</span>     true.  Notify children that their clipping frame has changed.
<span class='line'>1396</span>   */</span><span class="WHIT">
<span class='line'>1397</span>   </span><span class="NAME">_onscroll</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1398</span>     </span><span class="NAME">this._scrollFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1399</span>     </span><span class="NAME">this.notifyPropertyChange</span><span class="PUNC">(</span><span class="STRN">'scrollFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1400</span>     </span><span class="NAME">SC.Benchmark.start</span><span class="PUNC">(</span><span class="STRN">'%@.onscroll'</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1401</span>     </span><span class="NAME">this._invalidateClippingFrame</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1402</span>     </span><span class="NAME">SC.Benchmark.end</span><span class="PUNC">(</span><span class="STRN">'%@.onscroll'</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1403</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1404</span> 
<span class='line'>1405</span>   </span><span class="NAME">_frameChangeLevel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1406</span>   
<span class='line'>1407</span>   </span><span class="COMM">/** @private
<span class='line'>1408</span>     Used internally to collect client offset and location info.  If the 
<span class='line'>1409</span>     element is not in the main window or hidden, it will be added temporarily 
<span class='line'>1410</span>     and then the passed function will be called.
<span class='line'>1411</span>   */</span><span class="WHIT">
<span class='line'>1412</span>   </span><span class="NAME">_collectFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">func</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1413</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1414</span>     
<span class='line'>1415</span>     </span><span class="COMM">// if not visible in window, move parent node into window and get </span><span class="WHIT">
<span class='line'>1416</span>     </span><span class="COMM">// dim and offset.  If the element has no parentNode, then just move</span><span class="WHIT">
<span class='line'>1417</span>     </span><span class="COMM">// the element in.</span><span class="WHIT">
<span class='line'>1418</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isVisibleInWindow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isVisibleInWindow'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1419</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isVisibleInWindow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1420</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.parentNode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1421</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pn</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.window.rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">pn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1422</span>       
<span class='line'>1423</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pnParent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pn.parentNode</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// cache former parent node</span><span class="WHIT">
<span class='line'>1424</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pnSib</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pn.nextSibling</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// cache next sibling</span><span class="WHIT">
<span class='line'>1425</span>       </span><span class="NAME">SC.window.rootElement.insertBefore</span><span class="PUNC">(</span><span class="NAME">pn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1426</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1427</span> 
<span class='line'>1428</span>     </span><span class="COMM">// if view is not displayed, temporarily display it also</span><span class="WHIT">
<span class='line'>1429</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1430</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isHidden</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">display</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'none'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">display</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1431</span> 
<span class='line'>1432</span>     </span><span class="COMM">// All *Width and *Height properties give 0 on elements with display none,</span><span class="WHIT">
<span class='line'>1433</span>     </span><span class="COMM">// so enable the element temporarily</span><span class="WHIT">
<span class='line'>1434</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isHidden</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1435</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">els</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement.style</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1436</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">originalVisibility</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">els.visibility</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1437</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">originalPosition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">els.position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1438</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">originalDisplay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">els.display</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1439</span>       </span><span class="NAME">els.visibility</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'hidden'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1440</span>       </span><span class="NAME">els.position</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'absolute'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1441</span>       </span><span class="NAME">els.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'block'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1442</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1443</span> 
<span class='line'>1444</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">func.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1445</span>     
<span class='line'>1446</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isHidden</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1447</span>       </span><span class="NAME">els.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalDisplay</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1448</span>       </span><span class="NAME">els.position</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalPosition</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1449</span>       </span><span class="NAME">els.visibility</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalVisibility</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1450</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1451</span> 
<span class='line'>1452</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isVisibleInWindow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1453</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pnParent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1454</span>         </span><span class="NAME">pnParent.insertBefore</span><span class="PUNC">(</span><span class="NAME">pn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pnSib</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1455</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1456</span>         </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">pn.parentNode</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1457</span>           </span><span class="NAME">SC.window.rootElement.removeChild</span><span class="PUNC">(</span><span class="NAME">pn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1458</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1459</span>     </span><span class="PUNC">}</span><span class="WHIT">  
<span class='line'>1460</span>     
<span class='line'>1461</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1462</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1463</span>   
<span class='line'>1464</span>   </span><span class="COMM">/** @private
<span class='line'>1465</span>     Called whenever some aspect of the receiver's frames have changed that 
<span class='line'>1466</span>     probably has invalidated the child views clippingFrames.  Events that cause 
<span class='line'>1467</span>     this include:
<span class='line'>1468</span>     
<span class='line'>1469</span>     - change to the innerFrame size
<span class='line'>1470</span>     - change to the scrollFrame
<span class='line'>1471</span>     - change to the clippingFrame
<span class='line'>1472</span>     
<span class='line'>1473</span>     For performance reasons, this only passes onto children if they or a decendent 
<span class='line'>1474</span>     implements the clippingFrameDidChange method.
<span class='line'>1475</span>   */</span><span class="WHIT">
<span class='line'>1476</span>   </span><span class="NAME">_invalidateChildrenClippingFrames</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1477</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1478</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1479</span>       </span><span class="NAME">view._invalidateClippingFrame</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1480</span>       </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1481</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1482</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1483</span> 
<span class='line'>1484</span>   </span><span class="COMM">/** @private
<span class='line'>1485</span>     Called by a parentNode whenever the clippingFrame needs to be recalculated.
<span class='line'>1486</span>   */</span><span class="WHIT">
<span class='line'>1487</span>   </span><span class="NAME">_invalidateClippingFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">  
<span class='line'>1488</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'needsClippingFrame'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1489</span>       </span><span class="NAME">this._clippingFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1490</span>       </span><span class="NAME">this.clippingFrameDidChange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1491</span>       </span><span class="NAME">this.notifyPropertyChange</span><span class="PUNC">(</span><span class="STRN">'clippingFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1492</span>       </span><span class="NAME">this._invalidateChildrenClippingFrames</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1493</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1494</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1495</span>   
<span class='line'>1496</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>1497</span>   </span><span class="COMM">// PROPERTIES</span><span class="WHIT">
<span class='line'>1498</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1499</span> 
<span class='line'>1500</span>   </span><span class="COMM">/** 
<span class='line'>1501</span>     Used to show or hide the view. 
<span class='line'>1502</span>     
<span class='line'>1503</span>     If this property is set to NO, then the DOM element will be hidden using
<span class='line'>1504</span>     display:none.  You will often want to bind this property to some setting 
<span class='line'>1505</span>     in your application to make various parts of your app visible as needed.
<span class='line'>1506</span> 
<span class='line'>1507</span>     If you have animation enabled, then changing this property will actually
<span class='line'>1508</span>     trigger the animation to bring the view in or out.
<span class='line'>1509</span>     
<span class='line'>1510</span>     The default binding format is SC.Binding.Bool
<span class='line'>1511</span>     
<span class='line'>1512</span>     @field
<span class='line'>1513</span>     @type {Boolean}
<span class='line'>1514</span>   */</span><span class="WHIT">
<span class='line'>1515</span>   </span><span class="NAME">isVisible</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1516</span>   
<span class='line'>1517</span>   </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>1518</span>   </span><span class="NAME">isVisibleBindingDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.Binding.Bool</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1519</span>   
<span class='line'>1520</span>   </span><span class="COMM">/**
<span class='line'>1521</span>     (Read Only) The current display visibility of the view.
<span class='line'>1522</span>     
<span class='line'>1523</span>     Usually, this property will mirror the current state of the isVisible
<span class='line'>1524</span>     property.  However, if your view animates its visibility in and out, then
<span class='line'>1525</span>     this will not become false until the animation completes.
<span class='line'>1526</span>     
<span class='line'>1527</span>     @type {Boolean}
<span class='line'>1528</span>   */</span><span class="WHIT">
<span class='line'>1529</span>   </span><span class="NAME">displayIsVisible</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1530</span> 
<span class='line'>1531</span>   </span><span class="COMM">/**
<span class='line'>1532</span>     true when the view is actually visible in the DOM window.
<span class='line'>1533</span> 
<span class='line'>1534</span>     This property is set to true only when the view is (a) in the main DOM
<span class='line'>1535</span>     hierarchy and (b) all parent nodes are visible and (c) the receiver node
<span class='line'>1536</span>     is visible.
<span class='line'>1537</span>     
<span class='line'>1538</span>     @type {Boolean}
<span class='line'>1539</span>     @field
<span class='line'>1540</span>   */</span><span class="WHIT">
<span class='line'>1541</span>   </span><span class="NAME">isVisibleInWindow</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1542</span>   
<span class='line'>1543</span>   </span><span class="COMM">/**
<span class='line'>1544</span>     If true, the tooltip will be localized.  Also used by some subclasses.
<span class='line'>1545</span>     
<span class='line'>1546</span>     @type {Boolean}
<span class='line'>1547</span>     @field
<span class='line'>1548</span>   */</span><span class="WHIT">
<span class='line'>1549</span>   </span><span class="NAME">localize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1550</span> 
<span class='line'>1551</span>   </span><span class="COMM">/**
<span class='line'>1552</span>     Applied to the title attribute of the rootElement DOM if set. 
<span class='line'>1553</span>     
<span class='line'>1554</span>     If localize is true, then the toolTip will be localized first.
<span class='line'>1555</span>     
<span class='line'>1556</span>     @type {String}
<span class='line'>1557</span>     @field
<span class='line'>1558</span>   */</span><span class="WHIT">
<span class='line'>1559</span>   </span><span class="NAME">toolTip</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1560</span> 
<span class='line'>1561</span> 
<span class='line'>1562</span>   </span><span class="COMM">/**
<span class='line'>1563</span>     The HTML you want to use when creating a new element. 
<span class='line'>1564</span>     
<span class='line'>1565</span>     You can specify the HTML as a string of text, using the NodeDescriptor, or
<span class='line'>1566</span>     by pointing directly to an element.
<span class='line'>1567</span>     
<span class='line'>1568</span>     Note that as an optimization, SC.View will actually convert the value of 
<span class='line'>1569</span>     this property to an actual DOM structure the first time you create a view 
<span class='line'>1570</span>     and then clone the DOM structure for future views.  
<span class='line'>1571</span>     
<span class='line'>1572</span>     This means that in general you should only set the value of emptyElement 
<span class='line'>1573</span>     when you create a view subclass.  Changing this property value at other 
<span class='line'>1574</span>     times will often have no effect.
<span class='line'>1575</span>     
<span class='line'>1576</span>     @field
<span class='line'>1577</span>     @type {String}
<span class='line'>1578</span>   */</span><span class="WHIT">
<span class='line'>1579</span>   </span><span class="NAME">emptyElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"&lt;div>&lt;/div>"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1580</span>   
<span class='line'>1581</span>   </span><span class="COMM">/**
<span class='line'>1582</span>     If true, view will display in a lightbox when you show it.
<span class='line'>1583</span>     
<span class='line'>1584</span>     @field
<span class='line'>1585</span>     @type {Boolean}
<span class='line'>1586</span>   */</span><span class="WHIT">
<span class='line'>1587</span>   </span><span class="NAME">isPanel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1588</span> 
<span class='line'>1589</span>   </span><span class="COMM">/**
<span class='line'>1590</span>     If true, the view should be modal when shown as a panel.
<span class='line'>1591</span>   
<span class='line'>1592</span>     @field
<span class='line'>1593</span>     @type {Boolean}
<span class='line'>1594</span>   */</span><span class="WHIT">
<span class='line'>1595</span>   </span><span class="NAME">isModal</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1596</span>   
<span class='line'>1597</span>   </span><span class="COMM">/**
<span class='line'>1598</span>     Enable visible animation by default.
<span class='line'>1599</span>   */</span><span class="WHIT">
<span class='line'>1600</span>   </span><span class="NAME">isAnimationEnabled</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1601</span>   
<span class='line'>1602</span>   </span><span class="COMM">/**
<span class='line'>1603</span>     General support for animation.  Just call this method and it will build
<span class='line'>1604</span>     and play an animation starting from the current state.  The second param
<span class='line'>1605</span>     is optional.  It should either be a hash of animator options or an 
<span class='line'>1606</span>     animator object returned by a previous call to transitionTo().
<span class='line'>1607</span>   
<span class='line'>1608</span>   */</span><span class="WHIT">
<span class='line'>1609</span>   </span><span class="NAME">transitionTo</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">animator</span><span class="PUNC">,</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1610</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">animatorOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1611</span> 
<span class='line'>1612</span>     </span><span class="COMM">// Create or reset the animator.</span><span class="WHIT">
<span class='line'>1613</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">animator</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">animator._isAnimator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1614</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">finalStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">animator</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1615</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">"isAnimationEnabled"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">  </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1616</span>         </span><span class="NAME">animatorOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Object.clone</span><span class="PUNC">(</span><span class="NAME">animatorOptions</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1617</span>         </span><span class="NAME">animatorOptions.duration</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1618</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1619</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">animatorOptions.duration</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1620</span>         </span><span class="NAME">animatorOptions.duration</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">animatorOptions.duration</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1621</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1622</span> 
<span class='line'>1623</span>       </span><span class="NAME">animator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Animator.apply</span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">finalStyle</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">animatorOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1624</span>       </span><span class="NAME">animator._isAnimator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1625</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1626</span> 
<span class='line'>1627</span>     </span><span class="COMM">// trigger animation</span><span class="WHIT">
<span class='line'>1628</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">animator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1629</span>       </span><span class="NAME">animator.jumpTo</span><span class="PUNC">(</span><span class="NAME">animator.state</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1630</span>       </span><span class="NAME">animator.seekTo</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1631</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1632</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">animator</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">    
<span class='line'>1633</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1634</span> 
<span class='line'>1635</span>   </span><span class="COMM">/**
<span class='line'>1636</span>     The contents of the view as HTML. You can use this property to both 
<span class='line'>1637</span>     retrieve the content and to change it.  Use this property instead of 
<span class='line'>1638</span>     manually changing the content of your view as this property works around
<span class='line'>1639</span>     certain cross-browser bugs.
<span class='line'>1640</span>     
<span class='line'>1641</span>     @field
<span class='line'>1642</span>   */</span><span class="WHIT">
<span class='line'>1643</span>   </span><span class="NAME">innerHTML</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1644</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1645</span>       
<span class='line'>1646</span>       </span><span class="COMM">// Clear the text node.</span><span class="WHIT">
<span class='line'>1647</span>       </span><span class="NAME">this._textNode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1648</span>       
<span class='line'>1649</span>       </span><span class="COMM">// Safari2 has a bad habit of sometimes not actually changing its </span><span class="WHIT">
<span class='line'>1650</span>       </span><span class="COMM">// innerHTML. This will make sure the innerHTML get's changed properly.</span><span class="WHIT">
<span class='line'>1651</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isSafari</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">SC.isSafari3</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1652</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">reps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1653</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1654</span>           </span><span class="NAME">el.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">el.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1655</span>           </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">reps</span><span class="PUNC">++</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value.length</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.innerHTML</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1656</span>             </span><span class="NAME">f.invokeLater</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1657</span>           </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1658</span>         </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1659</span>         </span><span class="NAME">f</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1660</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1661</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1662</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1663</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1664</span> 
<span class='line'>1665</span>   </span><span class="COMM">/**
<span class='line'>1666</span>     The contents of the view as plain text.  You can use this property to
<span class='line'>1667</span>     both retrieve the content and to change it.  Use this property instead of
<span class='line'>1668</span>     the innerHTML property when you want to set plain text only as this 
<span class='line'>1669</span>     property is much faster.
<span class='line'>1670</span>   
<span class='line'>1671</span>     @field
<span class='line'>1672</span>   */</span><span class="WHIT">
<span class='line'>1673</span>   </span><span class="NAME">innerText</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1674</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1675</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1676</span> 
<span class='line'>1677</span>       </span><span class="COMM">// add a textNode if necessary</span><span class="WHIT">
<span class='line'>1678</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._textNode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1679</span>         </span><span class="NAME">this._textNode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1680</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1681</span>         </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">el.firstChild</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">el.removeChild</span><span class="PUNC">(</span><span class="NAME">el.firstChild</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1682</span>         </span><span class="NAME">el.appendChild</span><span class="PUNC">(</span><span class="NAME">this._textNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1683</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this._textNode.data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1684</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1685</span>     
<span class='line'>1686</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._textNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._textNode.data</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.innerHTML</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unescapeHTML</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1687</span>     
<span class='line'>1688</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1689</span>   
<span class='line'>1690</span> 
<span class='line'>1691</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>1692</span>   </span><span class="COMM">// SUPPORT METHODS</span><span class="WHIT">
<span class='line'>1693</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1694</span>   </span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1695</span>     </span><span class="NAME">arguments.callee.base.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1696</span> 
<span class='line'>1697</span>     </span><span class="COMM">// configure them outlets.</span><span class="WHIT">
<span class='line'>1698</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.BENCHMARK_CONFIGURE_OUTLETS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Benchmark.start</span><span class="PUNC">(</span><span class="STRN">'SC.View.configureOutlets'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1699</span>     </span><span class="NAME">this.configureOutlets</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1700</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.BENCHMARK_CONFIGURE_OUTLETS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Benchmark.end</span><span class="PUNC">(</span><span class="STRN">'SC.View.configureOutlets'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1701</span> 
<span class='line'>1702</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">toolTip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'toolTip'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1703</span>     </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">toolTip</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">toolTip</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this._updateToolTipObserver</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1704</span> 
<span class='line'>1705</span>     </span><span class="COMM">// if container element is a string, convert it to an actual DOM element.</span><span class="WHIT">
<span class='line'>1706</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">$type</span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">T_STRING</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1707</span>       </span><span class="NAME">this.containerElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$sel</span><span class="PUNC">(</span><span class="NAME">this.containerElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1708</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1709</span> 
<span class='line'>1710</span>     </span><span class="COMM">// register as a drop target and scrollable.</span><span class="WHIT">
<span class='line'>1711</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isDropTarget'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Drag.addDropTarget</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1712</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isScrollable'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Drag.addScrollableView</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1713</span>     
<span class='line'>1714</span>     </span><span class="COMM">// add scrollable handler</span><span class="WHIT">
<span class='line'>1715</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isScrollable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.rootElement.onscroll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.View._onscroll</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1716</span>     
<span class='line'>1717</span>     </span><span class="COMM">// setup isVisibleInWindow ;</span><span class="WHIT">
<span class='line'>1718</span>     </span><span class="NAME">this.isVisibleInWindow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.parentNode.get</span><span class="PUNC">(</span><span class="STRN">'isVisibleInWindow'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1719</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1720</span>   
<span class='line'>1721</span>   </span><span class="COMM">// this method looks through your outlets array and will try to</span><span class="WHIT">
<span class='line'>1722</span>   </span><span class="COMM">// reconfigure any missing ones.</span><span class="WHIT">
<span class='line'>1723</span>   </span><span class="NAME">configureOutlets</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1724</span>     
<span class='line'>1725</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.outlets</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.outlets.length</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1726</span> 
<span class='line'>1727</span>     </span><span class="COMM">// lookup outlets as selector paths or execute the function if there </span><span class="WHIT">
<span class='line'>1728</span>     </span><span class="COMM">// is one.</span><span class="WHIT">
<span class='line'>1729</span>     </span><span class="NAME">this.beginPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// bundle changes</span><span class="WHIT">
<span class='line'>1730</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oloc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">oloc</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.outlets.length</span><span class="PUNC">;</span><span class="NAME">oloc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1731</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.outlet</span><span class="PUNC">(</span><span class="NAME">this.outlets</span><span class="PUNC">[</span><span class="NAME">oloc</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1732</span>     </span><span class="PUNC">}</span><span class="WHIT">    
<span class='line'>1733</span>     </span><span class="NAME">this.endPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1734</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1735</span> 
<span class='line'>1736</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>1737</span>   </span><span class="COMM">// VISIBILITY METHODS</span><span class="WHIT">
<span class='line'>1738</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1739</span>   
<span class='line'>1740</span>   </span><span class="COMM">// Calling this method will show the view.  Don't call this method</span><span class="WHIT">
<span class='line'>1741</span>   </span><span class="COMM">// directly but instead set the isVisible property to true.  You can</span><span class="WHIT">
<span class='line'>1742</span>   </span><span class="COMM">// override this method to provide your own show capabilities.</span><span class="WHIT">
<span class='line'>1743</span>   </span><span class="NAME">show</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1744</span>     </span><span class="NAME">Element.show</span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1745</span>     </span><span class="NAME">this.removeClassName</span><span class="PUNC">(</span><span class="STRN">'hidden'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1746</span>     </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'displayIsVisible'</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1747</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1748</span> 
<span class='line'>1749</span>   </span><span class="COMM">// This is the primitive method for hiding a view.  It will be called when</span><span class="WHIT">
<span class='line'>1750</span>   </span><span class="COMM">// isVisible is set to false after an animation runs or immediate if no</span><span class="WHIT">
<span class='line'>1751</span>   </span><span class="COMM">// animation is defined.</span><span class="WHIT">
<span class='line'>1752</span>   </span><span class="NAME">hide</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1753</span>     </span><span class="NAME">Element.hide</span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1754</span>     </span><span class="NAME">this.addClassName</span><span class="PUNC">(</span><span class="STRN">'hidden'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1755</span>     </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'displayIsVisible'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1756</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1757</span> 
<span class='line'>1758</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>1759</span>   </span><span class="COMM">// DEPRECATED. DO NOT USE</span><span class="WHIT">
<span class='line'>1760</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1761</span> 
<span class='line'>1762</span>   </span><span class="COMM">// deprecated.  Included only for compatibility.</span><span class="WHIT">
<span class='line'>1763</span>   </span><span class="NAME">animateVisible</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1764</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'isAnimationEnabled'</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1765</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isAnimationEnabled'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1766</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'isAnimationEnabled'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1767</span> 
<span class='line'>1768</span> 
<span class='line'>1769</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>1770</span>   </span><span class="COMM">// PRIVATE METHODS</span><span class="WHIT">
<span class='line'>1771</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1772</span> 
<span class='line'>1773</span>   </span><span class="COMM">// this will set the rootElement, cleaning up any old element.</span><span class="WHIT">
<span class='line'>1774</span>   </span><span class="NAME">_attachRootElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1775</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.rootElement._configured</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1776</span>     </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1777</span>     </span><span class="NAME">el._configured</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._guid</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1778</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1779</span>   
<span class='line'>1780</span>   </span><span class="COMM">// This method is called internally after you add or remove a child view.</span><span class="WHIT">
<span class='line'>1781</span>   </span><span class="COMM">// It will rebuild the childNodes array to reflect all children.</span><span class="WHIT">
<span class='line'>1782</span>   </span><span class="NAME">_rebuildChildNodes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1783</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.firstChild</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1784</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">ret.push</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.nextSibling</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1785</span>     </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'childNodes'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1786</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1787</span>   
<span class='line'>1788</span>   </span><span class="NAME">_toolTipObserver</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1789</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">toolTip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'toolTip'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1790</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'localize'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">toolTip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">toolTip.loc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1791</span>     </span><span class="NAME">this.rootElement.title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">toolTip</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1792</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">observes</span><span class="PUNC">(</span><span class="STRN">"toolTip"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1793</span>   
<span class='line'>1794</span>   </span><span class="NAME">_isVisibleObserver</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1795</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">flag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1796</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this._isVisible</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">flag</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this._isVisible</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1797</span>       </span><span class="NAME">this._isVisible</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">flag</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1798</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">flag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1799</span>         </span><span class="NAME">this._show</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1800</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this._hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1801</span> 
<span class='line'>1802</span>       </span><span class="COMM">// update parent state.</span><span class="WHIT">
<span class='line'>1803</span>       </span><span class="NAME">this._updateIsVisibleInWindow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1804</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1805</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">observes</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1806</span>   
<span class='line'>1807</span>   </span><span class="NAME">_updateIsVisibleInWindow</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parentNodeState</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1808</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parentNodeState</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1809</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentNode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'parentNode'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1810</span>       </span><span class="NAME">parentNodeState</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">parentNode.get</span><span class="PUNC">(</span><span class="STRN">'isVisibleInWindow'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1811</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1812</span>     
<span class='line'>1813</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">visible</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentNodeState</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1814</span> 
<span class='line'>1815</span>     </span><span class="COMM">// if state changes, update and notify children.</span><span class="WHIT">
<span class='line'>1816</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">visible</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isVisibleInWindow'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1817</span>       </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'isVisibleInWindow'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">visible</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1818</span>       </span><span class="NAME">this.recacheFrames</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1819</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'firstChild'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1820</span>       </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1821</span>         </span><span class="NAME">child._updateIsVisibleInWindow</span><span class="PUNC">(</span><span class="NAME">visible</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1822</span>         </span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">child.get</span><span class="PUNC">(</span><span class="STRN">'nextSibling'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1823</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1824</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1825</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1826</span>   
<span class='line'>1827</span>   </span><span class="COMM">// Calling this method will show the view.  Don't call this method</span><span class="WHIT">
<span class='line'>1828</span>   </span><span class="COMM">// directly but instead set the isVisible property to true.  You can</span><span class="WHIT">
<span class='line'>1829</span>   </span><span class="COMM">// override this method to provide your own show capabilities.</span><span class="WHIT">
<span class='line'>1830</span>   </span><span class="NAME">_show</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">anchorView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">triggerEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1831</span>     </span><span class="COMM">// compatibility</span><span class="WHIT">
<span class='line'>1832</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.showView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.showView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1833</span> 
<span class='line'>1834</span>     </span><span class="COMM">// if this is a type of pane, call the pane manager.</span><span class="WHIT">
<span class='line'>1835</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">paneType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'paneType'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1836</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isPanel'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">paneType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.PANEL_PANE</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// compatibility</span><span class="WHIT">
<span class='line'>1837</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">paneType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1838</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">anchorView</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">anchorView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1839</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">triggerEvent</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">triggerEvent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1840</span>       </span><span class="NAME">SC.PaneManager.manager</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">showPaneView</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">paneType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">anchorView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">triggerEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1841</span>       </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'displayIsVisible'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1842</span>       
<span class='line'>1843</span>     </span><span class="COMM">// if an animation is defined and animations are configured, use that.</span><span class="WHIT">
<span class='line'>1844</span>     </span><span class="COMM">// the displayIsVisible property will be set to true when the animation</span><span class="WHIT">
<span class='line'>1845</span>     </span><span class="COMM">// completes.</span><span class="WHIT">
<span class='line'>1846</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.visibleAnimation</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isAnimationEnabled'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1847</span>       </span><span class="NAME">this._transitionVisibleTo</span><span class="PUNC">(</span><span class="NUMB">1.0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1848</span> 
<span class='line'>1849</span>       </span><span class="COMM">// at this point the animation has been reset to the beginng.  Run the </span><span class="WHIT">
<span class='line'>1850</span>       </span><span class="COMM">// core show() method immediately so the animation will be visible.</span><span class="WHIT">
<span class='line'>1851</span>       </span><span class="NAME">this.show</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1852</span>       
<span class='line'>1853</span>     </span><span class="COMM">// otherwise, just change over visible settings.</span><span class="WHIT">
<span class='line'>1854</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1855</span>       </span><span class="NAME">this._visibleAnimator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1856</span>       </span><span class="NAME">this.show</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1857</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1858</span> 
<span class='line'>1859</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1860</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1861</span> 
<span class='line'>1862</span>   </span><span class="NAME">_hide</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1863</span>     </span><span class="COMM">// compatibility</span><span class="WHIT">
<span class='line'>1864</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.hideView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.hideView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1865</span> 
<span class='line'>1866</span>     </span><span class="COMM">// if this is a type of pane, call the pane manager.</span><span class="WHIT">
<span class='line'>1867</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isPane</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'paneType'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isPanel'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1868</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isPane</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1869</span>       </span><span class="NAME">SC.PaneManager.manager</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">hidePaneView</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1870</span>       </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'displayIsVisible'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1871</span>       
<span class='line'>1872</span>     </span><span class="COMM">// if an animation is defined and animations are configured, use that.</span><span class="WHIT">
<span class='line'>1873</span>     </span><span class="COMM">// the displayIsVisible property will be set to false when the animation</span><span class="WHIT">
<span class='line'>1874</span>     </span><span class="COMM">// completes.</span><span class="WHIT">
<span class='line'>1875</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.visibleAnimation</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isAnimationEnabled'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1876</span>       </span><span class="NAME">this._transitionVisibleTo</span><span class="PUNC">(</span><span class="NUMB">0.0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1877</span>       
<span class='line'>1878</span>     </span><span class="COMM">// otherwise, just change over visible settings.</span><span class="WHIT">
<span class='line'>1879</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1880</span>       </span><span class="NAME">this._visibleAnimator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1881</span>       </span><span class="NAME">this.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1882</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1883</span>      
<span class='line'>1884</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1885</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1886</span>   
<span class='line'>1887</span>   
<span class='line'>1888</span>   </span><span class="NAME">_transitionVisibleTo</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1889</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1890</span> 
<span class='line'>1891</span>     </span><span class="COMM">// if an animator already exists, just transition to the new state.</span><span class="WHIT">
<span class='line'>1892</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._visibleAnimator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1893</span>       </span><span class="NAME">this.transitionTo</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">this._visibleAnimator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1894</span>       
<span class='line'>1895</span>     </span><span class="COMM">// otherwise, build the animator from the options passed.  Patch in our</span><span class="WHIT">
<span class='line'>1896</span>     </span><span class="COMM">// own onComplete handler.</span><span class="WHIT">
<span class='line'>1897</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1898</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.visibleAnimation</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1899</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">opts.hidden</span><span class="PUNC">,</span><span class="NAME">opts.visible</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1900</span>       </span><span class="NAME">opts.onComplete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class='line'>1901</span>         </span><span class="NAME">this._animateVisibleDidComplete.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">opts.onComplete</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1902</span>       </span><span class="NAME">this._visibleAnimator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.transitionTo</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">      
<span class='line'>1903</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1904</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1905</span> 
<span class='line'>1906</span>   </span><span class="COMM">// This is called when the animation completes.  Finish cleaning up the</span><span class="WHIT">
<span class='line'>1907</span>   </span><span class="COMM">// visibility section.</span><span class="WHIT">
<span class='line'>1908</span>   </span><span class="NAME">_animateVisibleDidComplete</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">chainFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1909</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1910</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">chainFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">chainFunc</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1911</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1912</span>   
<span class='line'>1913</span>   </span><span class="NAME">_firstResponderObserver</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1914</span>     </span><span class="NAME">this.setClassName</span><span class="PUNC">(</span><span class="STRN">'focus'</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1915</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">observes</span><span class="PUNC">(</span><span class="STRN">'isFirstResponder'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1916</span>   
<span class='line'>1917</span>   </span><span class="NAME">_dropTargetObserver</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1918</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isDropTarget'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1919</span>       </span><span class="NAME">SC.Drag.addDropTarget</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1920</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">SC.Drag.removeDropTarget</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1921</span>   </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">observes</span><span class="PUNC">(</span><span class="STRN">'isDropTarget'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1922</span>   
<span class='line'>1923</span>   </span><span class="COMM">// .............................................</span><span class="WHIT">
<span class='line'>1924</span>   </span><span class="COMM">// SPECIAL TYPES OF VIEWS</span><span class="WHIT">
<span class='line'>1925</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1926</span> 
<span class='line'>1927</span>   </span><span class="COMM">// This will show the pane as a popup or picker (depending on the paneType</span><span class="WHIT">
<span class='line'>1928</span>   </span><span class="COMM">// you have set.)  This works just like setting isVisible to true, except</span><span class="WHIT">
<span class='line'>1929</span>   </span><span class="COMM">// that it also passes the anchorView and triggerEvent you pass in.</span><span class="WHIT">
<span class='line'>1930</span>   </span><span class="NAME">popup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">anchorView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">triggerEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1931</span>     
<span class='line'>1932</span>     </span><span class="COMM">// this will bypass the normal observer machinery, calling the private</span><span class="WHIT">
<span class='line'>1933</span>     </span><span class="COMM">// _show method ourselves.  To avoid triggering _show twice, we patch up</span><span class="WHIT">
<span class='line'>1934</span>     </span><span class="COMM">// the internal _isVisible property.</span><span class="WHIT">
<span class='line'>1935</span>     </span><span class="NAME">this._isVisible</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1936</span>     </span><span class="NAME">this._show</span><span class="PUNC">(</span><span class="NAME">anchorView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">triggerEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1937</span>     </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1938</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1939</span>   
<span class='line'>1940</span>   </span><span class="COMM">// This can be used to manually add observers to the rootElement for the </span><span class="WHIT">
<span class='line'>1941</span>   </span><span class="COMM">// methods in the passed map.  You generally don't want to do this since we </span><span class="WHIT">
<span class='line'>1942</span>   </span><span class="COMM">// handle event propgation through the responder chain.</span><span class="WHIT">
<span class='line'>1943</span>   </span><span class="NAME">configureObserverMethods</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">methodMap</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1944</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">methodMap</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1945</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">methodMap.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1946</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1947</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">bindAsEventListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1948</span>         </span><span class="NAME">Event.observe</span><span class="PUNC">(</span><span class="NAME">this.rootElement</span><span class="PUNC">,</span><span class="NAME">methodMap</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1949</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1950</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1951</span>   </span><span class="PUNC">}</span><span class="COMM">//,</span><span class="WHIT">
<span class='line'>1952</span>   
<span class='line'>1953</span>   </span><span class="COMM">// toString: function() {</span><span class="WHIT">
<span class='line'>1954</span>   </span><span class="COMM">//   var el = this.rootElement ;</span><span class="WHIT">
<span class='line'>1955</span>   </span><span class="COMM">//   var tagName = (!!el.tagName) ? el.tagName.toLowerCase() : 'document' ;</span><span class="WHIT">
<span class='line'>1956</span>   </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>1957</span>   </span><span class="COMM">//   var className = el.className ;</span><span class="WHIT">
<span class='line'>1958</span>   </span><span class="COMM">//   className = (className && className.length>0) ? 'class=%@'.fmt(className) : null;</span><span class="WHIT">
<span class='line'>1959</span>   </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>1960</span>   </span><span class="COMM">//   var idName = el.id ;</span><span class="WHIT">
<span class='line'>1961</span>   </span><span class="COMM">//   idName = (idName && idName.length>0) ? 'id=%@'.fmt(idName) : null;</span><span class="WHIT">
<span class='line'>1962</span>   </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>1963</span>   </span><span class="COMM">//   return "%@:%@&lt;%@>".fmt(this._type, this._guid, [tagName,idName, className].compact().join(' ')) ;</span><span class="WHIT">
<span class='line'>1964</span>   </span><span class="COMM">// }</span><span class="WHIT">
<span class='line'>1965</span>     
<span class='line'>1966</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1967</span>   
<span class='line'>1968</span> </span><span class="COMM">// Class Methods</span><span class="WHIT">
<span class='line'>1969</span> </span><span class="NAME">SC.View.mixin</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">  
<span class='line'>1970</span> 
<span class='line'>1971</span>   </span><span class="COMM">// this is the global registry of views.  It's used to map elements back</span><span class="WHIT">
<span class='line'>1972</span>   </span><span class="COMM">// to the views that own them.</span><span class="WHIT">
<span class='line'>1973</span>   </span><span class="NAME">_view</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1974</span>   
<span class='line'>1975</span>   </span><span class="NAME">findViewForElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1976</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">guid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el._configured</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1977</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">guid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">SC.View._view</span><span class="PUNC">[</span><span class="NAME">guid</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">  
<span class='line'>1978</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1979</span>   
<span class='line'>1980</span>   </span><span class="COMM">// ..........................................</span><span class="WHIT">
<span class='line'>1981</span>   </span><span class="COMM">// SETUP</span><span class="WHIT">
<span class='line'>1982</span>   </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1983</span>   </span><span class="COMM">// This works much like create except that it works on the passed in</span><span class="WHIT">
<span class='line'>1984</span>   </span><span class="COMM">// element instead of trying to find something new.  If you pass null for </span><span class="WHIT">
<span class='line'>1985</span>   </span><span class="COMM">// the first parameter,  then a new element will be created with the html</span><span class="WHIT">
<span class='line'>1986</span>   </span><span class="COMM">// you set in content.</span><span class="WHIT">
<span class='line'>1987</span>   </span><span class="NAME">viewFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">,</span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1988</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1989</span> 
<span class='line'>1990</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.idt.active</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">vStart</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1991</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.idt.v_count</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1992</span> 
<span class='line'>1993</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">vStart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1994</span>     
<span class='line'>1995</span>     </span><span class="COMM">// find or build the element.</span><span class="WHIT">
<span class='line'>1996</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">    
<span class='line'>1997</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">emptyElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.prototype._cachedEmptyElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.prototype.emptyElement</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1998</span>       
<span class='line'>1999</span>       </span><span class="COMM">// if the emptyElement is a string not starting with '&lt;', treat it like </span><span class="WHIT">
<span class='line'>2000</span>       </span><span class="COMM">// an id and find it in the doc.  If an element is found, cache it for</span><span class="WHIT">
<span class='line'>2001</span>       </span><span class="COMM">// future use.</span><span class="WHIT">
<span class='line'>2002</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">emptyElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>2003</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isString</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">emptyElement.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'&lt;'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2004</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$sel</span><span class="PUNC">(</span><span class="NAME">emptyElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2005</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2006</span>           </span><span class="NAME">this.prototype.emptyElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">emptyElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2007</span>           </span><span class="NAME">isString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2008</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2009</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2010</span> 
<span class='line'>2011</span>       </span><span class="COMM">// if still a string, then use it to create HTML.  Save the generated </span><span class="WHIT">
<span class='line'>2012</span>       </span><span class="COMM">// element so that we can avoid doing this over again.</span><span class="WHIT">
<span class='line'>2013</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isString</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2014</span>         </span><span class="NAME">SC._ViewCreator.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">emptyElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2015</span>         </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">SC._ViewCreator.firstChild</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2016</span>         </span><span class="NAME">SC.NodeCache.appendChild</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2017</span>         </span><span class="NAME">this.prototype._cachedEmptyElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.cloneNode</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2018</span>         
<span class='line'>2019</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">emptyElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2020</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">emptyElement.tagName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2021</span>           </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">emptyElement.cloneNode</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2022</span>         </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.NodeDescriptor.create</span><span class="PUNC">(</span><span class="NAME">emptyElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2023</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2024</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2025</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.idt.vc_t</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">vStart</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2026</span> 
<span class='line'>2027</span>     </span><span class="COMM">// configure only once.</span><span class="WHIT">
<span class='line'>2028</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">el._configured</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.View.findViewForElement</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>2029</span>     
<span class='line'>2030</span>     </span><span class="COMM">// Now that we have found an element, instantiate the view.</span><span class="WHIT">
<span class='line'>2031</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.$A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">rootElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2032</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">vStart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2033</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// create instance.</span><span class="WHIT">
<span class='line'>2034</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.idt.v_t</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">vStart</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2035</span>     </span><span class="NAME">el._configured</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret._guid</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2036</span> 
<span class='line'>2037</span>     </span><span class="COMM">// return the view.</span><span class="WHIT">
<span class='line'>2038</span>     </span><span class="NAME">SC.View._view</span><span class="PUNC">[</span><span class="NAME">ret._guid</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2039</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">    
<span class='line'>2040</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2041</span>   
<span class='line'>2042</span>   </span><span class="COMM">// create in the view work is like viewFor but with 'null' for el</span><span class="WHIT">
<span class='line'>2043</span>   </span><span class="NAME">create</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">configs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2044</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.$A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2045</span>     </span><span class="NAME">args.unshift</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2046</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.viewFor.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">  
<span class='line'>2047</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2048</span>   
<span class='line'>2049</span>   </span><span class="COMM">// extend works just like a normal extend except that we need to delete the cached empty</span><span class="WHIT">
<span class='line'>2050</span>   </span><span class="COMM">// element.</span><span class="WHIT">
<span class='line'>2051</span>   </span><span class="NAME">extend</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">configs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2052</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Object.extend.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">  
<span class='line'>2053</span>     </span><span class="NAME">ret.prototype._cachedEmptyElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2054</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2055</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2056</span> 
<span class='line'>2057</span>   </span><span class="COMM">/** 
<span class='line'>2058</span>     Defines a view as an outlet.  This will return an function that
<span class='line'>2059</span>     can be executed at a later time to actually create itself as an outlet.
<span class='line'>2060</span>   */</span><span class="WHIT">
<span class='line'>2061</span>   </span><span class="NAME">outletFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2062</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">viewClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// save the view class</span><span class="WHIT">
<span class='line'>2063</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">func</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2064</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.BENCHMARK_OUTLETS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Benchmark.start</span><span class="PUNC">(</span><span class="STRN">"OUTLET(%@)"</span><span class="PUNC">.</span><span class="NAME">format</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2065</span> 
<span class='line'>2066</span>       </span><span class="COMM">// if no path was passed, then create the view from scratch</span><span class="WHIT">
<span class='line'>2067</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2068</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">viewClass.viewFor</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2069</span>         
<span class='line'>2070</span>       </span><span class="COMM">// otherwise, try to find the HTML element identified by the path.</span><span class="WHIT">
<span class='line'>2071</span>       </span><span class="COMM">// If the element cannot be found in the caller (the owner view), then</span><span class="WHIT">
<span class='line'>2072</span>       </span><span class="COMM">// search the entire document.</span><span class="WHIT">
<span class='line'>2073</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2074</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.$$sel</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.$$sel</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$$sel</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2075</span> 
<span class='line'>2076</span>         </span><span class="COMM">// if some HTML has been found, then loop through and create views for each </span><span class="WHIT">
<span class='line'>2077</span>         </span><span class="COMM">// one.  Be sure to setup the proper parent view.</span><span class="WHIT">
<span class='line'>2078</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2079</span>           </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">owner</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">views</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2080</span>           </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">loc</span><span class="PUNC">&lt;</span><span class="NAME">ret.length</span><span class="PUNC">;</span><span class="NAME">loc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2081</span>             
<span class='line'>2082</span>             </span><span class="COMM">// create the new view instance</span><span class="WHIT">
<span class='line'>2083</span>             </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">viewClass.viewFor</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">[</span><span class="NAME">loc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">owner</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">owner</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2084</span>             
<span class='line'>2085</span>             </span><span class="COMM">// if successful, then we need to determine the new parentNode.</span><span class="WHIT">
<span class='line'>2086</span>             </span><span class="COMM">// then walk up the DOM tree to find the first parent element </span><span class="WHIT">
<span class='line'>2087</span>             </span><span class="COMM">// managed by a view (including this).</span><span class="WHIT">
<span class='line'>2088</span>             </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>2089</span>             </span><span class="COMM">// If a matching view is not found, but the view IS in a DOM</span><span class="WHIT">
<span class='line'>2090</span>             </span><span class="COMM">// somewhere then make the view a child of either SC.page or </span><span class="WHIT">
<span class='line'>2091</span>             </span><span class="COMM">// SC.window.</span><span class="WHIT">
<span class='line'>2092</span>             </span><span class="COMM">//  </span><span class="WHIT">
<span class='line'>2093</span>             </span><span class="COMM">// Add the view to the list of child views also.</span><span class="WHIT">
<span class='line'>2094</span>             </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>2095</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">view.rootElement</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">view.rootElement.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2096</span>               </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">node</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.rootElement.parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2097</span>               </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2098</span> 
<span class='line'>2099</span>               </span><span class="COMM">// go up the chain.  stop when we find a parent view, or the rootElement</span><span class="WHIT">
<span class='line'>2100</span>               </span><span class="COMM">// for SC.page.</span><span class="WHIT">
<span class='line'>2101</span>               </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">node</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">parentView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2102</span>                 </span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2103</span>                 </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2104</span>                   </span><span class="NAME">parentView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2105</span>                   </span><span class="KEYW">break</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2106</span>                 </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.page.rootElement</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2107</span>                   </span><span class="NAME">parentView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.page</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2108</span>                   </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2109</span>                 </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.window.rootElement</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2110</span>                   </span><span class="NAME">parentView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.window</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2111</span>                   </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>2112</span>                 </span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2113</span>                   </span><span class="NAME">node</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">node.parentNode</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>2114</span>                 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2115</span>               </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2116</span> 
<span class='line'>2117</span>               </span><span class="COMM">// if a parentView was found, then add to parentView.</span><span class="WHIT">
<span class='line'>2118</span>               </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parentView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2119</span>                 </span><span class="NAME">parentView._insertBefore</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2120</span>                 </span><span class="NAME">parentView._rebuildChildNodes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// this is not done with _insertBefore.</span><span class="WHIT">
<span class='line'>2121</span>                 </span><span class="NAME">view._updateIsVisibleInWindow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2122</span>               </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2123</span>               
<span class='line'>2124</span>             </span><span class="COMM">// view is not in a DOM. nothing to do.</span><span class="WHIT">
<span class='line'>2125</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2126</span> 
<span class='line'>2127</span>             </span><span class="COMM">// add to return array</span><span class="WHIT">
<span class='line'>2128</span>             </span><span class="NAME">views</span><span class="PUNC">[</span><span class="NAME">views.length</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2129</span>             
<span class='line'>2130</span>           </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2131</span>           </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">views</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2132</span>           </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">ret.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2133</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2134</span>         
<span class='line'>2135</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2136</span>       
<span class='line'>2137</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.BENCHMARK_OUTLETS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Benchmark.end</span><span class="PUNC">(</span><span class="STRN">"OUTLET(%@)"</span><span class="PUNC">.</span><span class="NAME">format</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2138</span>       </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2139</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2140</span>     </span><span class="NAME">func.isOutlet</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2141</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">func</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2142</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2143</span>   
<span class='line'>2144</span>   </span><span class="NAME">automaticOutletFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2145</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.outletFor.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2146</span>     </span><span class="NAME">ret.autoconfiguredOutlet</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2147</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2148</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2149</span> 
<span class='line'>2150</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2151</span> 
<span class='line'>2152</span> </span><span class="COMM">// IE Specfic Overrides</span><span class="WHIT">
<span class='line'>2153</span> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.Platform.IE</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2154</span>   </span><span class="NAME">SC.View.prototype.getStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2155</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">element</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2156</span> 
<span class='line'>2157</span>     </span><span class="COMM">// collect value</span><span class="WHIT">
<span class='line'>2158</span>     </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'float'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'cssFloat'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'styleFloat'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">style.camelize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2159</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">element.style</span><span class="PUNC">[</span><span class="NAME">style</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2160</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">element.currentStyle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">element.currentStyle</span><span class="PUNC">[</span><span class="NAME">style</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2161</span> 
<span class='line'>2162</span>     </span><span class="COMM">// handle opacity</span><span class="WHIT">
<span class='line'>2163</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'opacity'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2164</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="STRN">'filter'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">match</span><span class="PUNC">(</span><span class="REGX">/alpha\(opacity=(.*)\)/</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2165</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="REGX">/ 100;
<span class='line'>2166</span>       }
<span class='line'>2167</span>       value = 1.0;
<span class='line'>2168</span>     }
<span class='line'>2169</span> 
<span class='line'>2170</span>     /</span><span class="REGX">/ handle auto
<span class='line'>2171</span>     if (value === 'auto') {
<span class='line'>2172</span>       switch(style) {
<span class='line'>2173</span>         case 'width':
<span class='line'>2174</span>           if (this.getStyle('display') === 'none') {
<span class='line'>2175</span>             value = null ;
<span class='line'>2176</span>           } else if (element.currentStyle) {
<span class='line'>2177</span>             var paddingLeft = parseInt(element.currentStyle.paddingLeft,0)||0;
<span class='line'>2178</span>             var paddingRight = parseInt(element.currentStyle.paddingRight,0)||0;
<span class='line'>2179</span>             var borderLeftWidth = parseInt(element.currentStyle.borderLeftWidth, 0) || 0 ;
<span class='line'>2180</span>             var borderRightWidth = parseInt(element.currentStyle.borderRightWidth, 0) || 0 ;
<span class='line'>2181</span>             value = (element.offsetWidth - paddingLeft - paddingRight - borderLeftWidth - borderRightWidth) + 'px' ;
<span class='line'>2182</span>           }
<span class='line'>2183</span>           break ;
<span class='line'>2184</span>         case 'height':
<span class='line'>2185</span>           if (this.getStyle('display') === 'none') {
<span class='line'>2186</span>             value = null ;
<span class='line'>2187</span>           } else if (element.currentStyle) {
<span class='line'>2188</span>             var paddingTop = parseInt(element.currentStyle.paddingTop,0)||0;
<span class='line'>2189</span>             var paddingBottom = parseInt(element.currentStyle.paddingBottom,0)||0;
<span class='line'>2190</span>             var borderTopWidth = parseInt(element.currentStyle.borderTopWidth, 0) || 0 ;
<span class='line'>2191</span>             var borderBottomWidth = parseInt(element.currentStyle.borderBottomWidth, 0) || 0 ;
<span class='line'>2192</span>             value = (element.offsetHeight - paddingTop - paddingBottom - borderTopWidth - borderBottomWidth) + 'px' ;
<span class='line'>2193</span>           }
<span class='line'>2194</span> 
<span class='line'>2195</span>           break ;
<span class='line'>2196</span>         default:
<span class='line'>2197</span>           value = null ;
<span class='line'>2198</span>       }
<span class='line'>2199</span>     }
<span class='line'>2200</span> 
<span class='line'>2201</span>     return value;
<span class='line'>2202</span>   };
<span class='line'>2203</span>   
<span class='line'>2204</span>   /</span><span class="REGX">/ Called from innerFrame to actually collect the values for the innerFrame.
<span class='line'>2205</span>   /</span><span class="REGX">/ Normally the value we want for the width/</span><span class="NAME">height</span><span class="WHIT"> </span><span class="NAME">is</span><span class="WHIT"> </span><span class="NAME">stored</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">clientWidth</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>2206</span>   </span><span class="COMM">// height but in IE this is only good if the element hasLayout.  In this</span><span class="WHIT">
<span class='line'>2207</span>   </span><span class="COMM">// case always use the scrollWidth/Height.</span><span class="WHIT">
<span class='line'>2208</span>   </span><span class="NAME">SC.View._collectInnerFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2209</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2210</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hasLayout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.currentStyle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">el.currentStyle.hasLayout</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2211</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">borderTopWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">el.currentStyle.borderTopWidth</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2212</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">borderBottomWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">el.currentStyle.borderBottomWidth</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2213</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">scrollHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">el.offsetHeight</span><span class="PUNC">-</span><span class="NAME">borderTopWidth</span><span class="PUNC">-</span><span class="NAME">borderBottomWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2214</span>     </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">el.clientWidth</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">el.scrollWidth</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2215</span>     </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2216</span>       </span><span class="NAME">scrollHeight</span><span class="PUNC">-</span><span class="NUMB">15</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2217</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2218</span>     
<span class='line'>2219</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>2220</span>       </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetLeft</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>2221</span>       </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetTop</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>2222</span>       </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">hasLayout</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">el.scrollWidth</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">el.clientWidth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.scrollWidth</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>2223</span>       </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">hasLayout</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">scrollHeight</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">el.clientHeight</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">scrollHeight</span><span class="WHIT">
<span class='line'>2224</span>     </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2225</span>   </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2226</span>   
<span class='line'>2227</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2228</span>   
<span class='line'>2229</span>   </span><span class="COMM">// Called from innerFrame to actually collect the values for the innerFrame.</span><span class="WHIT">
<span class='line'>2230</span>   </span><span class="COMM">// This method should return the smaller of the scrollWidth/height (which</span><span class="WHIT">
<span class='line'>2231</span>   </span><span class="COMM">// will be set if the element is scrollable), or the clientWdith/height </span><span class="WHIT">
<span class='line'>2232</span>   </span><span class="COMM">// (which is set if the element is not scrollable).</span><span class="WHIT">
<span class='line'>2233</span>   </span><span class="NAME">SC.View._collectInnerFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2234</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.rootElement</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2235</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>2236</span>       </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetLeft</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>2237</span>       </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">el.offsetTop</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>2238</span>       </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">el.scrollWidth</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">el.clientWidth</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>2239</span>       </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">el.scrollHeight</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">el.clientHeight</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='line'>2240</span>     </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2241</span>   </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2242</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2243</span> 
<span class='line'>2244</span> 
<span class='line'>2245</span> </span><span class="COMM">// this handler goes through the guid to avoid any potential memory leaks</span><span class="WHIT">
<span class='line'>2246</span> </span><span class="NAME">SC.View._onscroll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">$view</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">_onscroll</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2247</span> 
<span class='line'>2248</span> </span><span class="NAME">SC.View.WIDTH_PADDING_STYLES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'paddingLeft'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'paddingRight'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderLeftWidth'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderRightWidth'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2249</span> 
<span class='line'>2250</span> </span><span class="NAME">SC.View.HEIGHT_PADDING_STYLES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'paddingTop'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'paddingBottom'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderTopWidth'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderBottomWidth'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2251</span> 
<span class='line'>2252</span> </span><span class="NAME">SC.View.SCROLL_WIDTH_PADDING_STYLES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'borderLeftWidth'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderRightWidth'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2253</span> </span><span class="NAME">SC.View.SCROLL_HEIGHT_PADDING_STYLES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'borderTopWidth'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'borderBottomWidth'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2254</span> 
<span class='line'>2255</span> </span><span class="NAME">SC.View.elementFor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.View.viewFor</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Old Sprout Compatibility.</span><span class="WHIT">
<span class='line'>2256</span> 
<span class='line'>2257</span> </span><span class="COMM">// This div is used to create nodes.  It should normally remain empty.</span><span class="WHIT">
<span class='line'>2258</span> </span><span class="NAME">SC._ViewCreator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2259</span> 
<span class='line'>2260</span> </span><span class="COMM">// This div can be used to hold elements you don't want on the page right now.</span><span class="WHIT">
<span class='line'>2261</span> </span><span class="NAME">SC.NodeCache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2262</span> </span></pre></body></html>